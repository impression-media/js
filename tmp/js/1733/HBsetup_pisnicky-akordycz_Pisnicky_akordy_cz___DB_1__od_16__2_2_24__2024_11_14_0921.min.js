/* Version: V_06_e */
console.log('imBlackBoxScript: https://hb.impressionmedia.cz/tmp/sas/sasAdapter.js');
            var script = document.createElement('script');
            script.type = 'text/javascript';
            script.id = 'hb-sasAdapter';
            script.src = 'https://hb.impressionmedia.cz/tmp/sas/sasAdapter.js';
            document.getElementsByTagName('head')[0].appendChild(script);

/* Header bidding from Impression Media 
 * Generate by script: updateCodeGoogleDevelopment     
 * Last update: 14.11.2024 9:21:50
 * Ticket ID: ... / [1733]
 * Generated for WebSite: [https://pisnicky-akordy.cz]
 * User ID: [1]    
 * Custom ticket name: [Pisnicky-akordy.cz + DB_1 (od 16.02.2024)]
 * Project date: 23.8.2019 by Weuron s.r.o. 
*/

var imCurrentSc = document.currentScript.src;
var imCDN;
if (imCurrentSc.toLowerCase().indexOf('jsdelivr') >= 0){ var imCDN = 1; }else{ var imCDN = 0; }
console.log('imCDN: '+imCDN);


//document.addEventListener('DOMContentLoaded', (event) => {
//    var imHbDomContentLoaded = 'ImHbIsReady';
//    console.log('DOM event fully loaded and parsed');
//}); 

//document.onreadystatechange = () => {
//  console.log('DOM readyState: '+document.readyState);
//  if (document.readyState === 'complete') {
//    console.log('DOM event readyState complete');
//  }
//};    



    
function newIndividualCss(css, id){
    console.log('Fire newIndividualCss: '+id);
    var styleNode, selection;
    var contentStyleTop = css;
    if ((styleNode = top.document.createElement("style")).id = "imHb-"+id, styleNode.type = "text/css", window.attachEvent && !window.opera){ 
        styleNode.styleSheet.cssText = contentStyleTop;
        console.log('imHB branding :: chrom OK: '+contentStyleTop);
    }else{
        var styleText = document.createTextNode(contentStyleTop);
        styleNode.appendChild(styleText)
    }
    top.document.getElementsByTagName("head")[0].appendChild(styleNode);
}

function newBehaviourBranding(unitCustomID){
    console.log('Fire fc newBehaviourBranding()');

//    responsiveConditionReady = document.querySelector(".box-imHbBrandingRam") !== null;                
//    if (responsiveConditionReady) {
//        console.log('1b body > .box-imHbBrandingRam fire remove');    
//        document.querySelector("body > .box-imHbBrandingRam").remove();
//    }

    var imHbBrandigDiv = document.createElement('div');
    imHbBrandigDiv.className = 'box-imHbBrandingRam';
    imHbBrandigDiv.innerHTML = '<div class="imHbBrandingRam fcNewBehaviourBranding" style="position: absolute; width: 100%; height: auto; z-index: 0; min-height: 0px;"><div id="'+unitCustomID+'" class="imHbUnitCustomID" style="width: 2000px; min-height: 0px; height: auto;overflow: visible;top: 0px;position: fixed; z-index: 0;left: 50%;margin-left: -1000px;display: block;pointer-events: auto !important;"></div></div>';
    document.body.insertBefore(imHbBrandigDiv, document.body.childNodes[0]);

}
setTimeout(function(){
    responsiveConditionReady = document.querySelector(".box-imHbBrandingRam") !== null;                
    if (responsiveConditionReady) {
        var allImHbBrandingRams = document.querySelectorAll(".box-imHbBrandingRam");
        for (var i = 0, element; element = allImHbBrandingRams[i]; i++) {
            //work with element
            responsiveConditionReady = element.querySelector("iframe") !== null;
            if (responsiveConditionReady) {}else{console.log('timeout box-imHbBrandingRam fire remove'); element.remove();}
        }
    }
}, 4000); 


        
function imHbbrandingplus(){
    console.log('ID: brandingPlus >> OK: ' + responsiveConditionReady); 
    responsiveConditionReady = document.querySelector("#brandingPlus").innerHTML;            
    if(responsiveConditionReady == ''){
        console.log('Content in ID: brandingPlus is empty');
    }else{
        console.log('Fire remove content in ID: brandingPlus >> HTML: '+ responsiveConditionReady); 
        document.querySelector("#brandingPlus").innerHTML = '';            
    }
//            responsiveConditionReady = document.querySelector("#imHbBrandingRam") !== null;
//            if (responsiveConditionReady) {
//                document.querySelector('#imHbBrandingRam').remove();
//            }
//            responsiveConditionReady = document.querySelector(".box-imHbBrandingRam") !== null;                
//            if (responsiveConditionReady) {
//                console.log('1a body > .box-imHbBrandingRam fire remove');
//                document.querySelector(".box-imHbBrandingRam").remove();
//            }
            responsiveConditionReady = document.querySelector("#brandingPlus") !== null;
            if (responsiveConditionReady) {
                document.querySelector("#brandingPlus").remove();
            }
            console.log('Fire fc newIndividualCss() /imHbbrandingplus/');            
            newIndividualCss('.branding #adform_leaderboard{margin-top:0px !important}#brandingPlus{top:53px !important}.imHbBranding{margin-top:253px}body .cbody .main{margin-top:0px; padding-top:8px}', 'imHbbrandingplus');
        

            console.log('Fire fc newBehaviourBranding()'); 
            newBehaviourBranding('brandingPlus');

                var loadedBranding = document.getElementById('brandingPlus');
                loadedBranding.addEventListener("DOMNodeInserted", function (e) {
                    console.log('isNewBreandingReady >> DOMNodeInserted: brandingPlus');
                    responsiveConditionReady = document.querySelector("#adform_leaderboard div iframe") !== null;
                    if (responsiveConditionReady) {
                        document.querySelector("#adform_leaderboard").remove();
                    }
                    var loadedBranding = document.querySelector("#branding div iframe");
                    if(loadedBranding){
                        console.log('isNewBreandingReady >> DOMNodeInserted >> iframe');
                        loadedBranding.onload = function() {
                            console.log('isNewBreandingReady >> DOMNodeInserted >> iframe >> remove adform_leaderboard');
                            top.document.body.classList.remove("imHbBranding");
                            top.document.body.className = top.document.body.className + " imHbBranding";
                            responsiveConditionReady = document.querySelector("#adform_leaderboard") !== null;
                            if (responsiveConditionReady) {
//verze branding = slepÃ¡ kolej 
//                                document.querySelector("#adform_leaderboard").remove();
//verze branding = poskakuje pri zmene z leaderboardu 
//                                var removeDivIdObject = document.querySelector("#adform_leaderboard");
//                                removeDivIdObject.innerHTML = '';
//                                removeDivIdObject.style.height = 'auto';
//                                removeDivIdObject.style.minHeight = '0px';                                    
                            } 
                        }
                    }                   
                }, false);
                    
}
var imHbbrandingplusCount = 0;
function imHbbrandingplusFire(){
//    console.log('Fire fc imHbbrandingplusFire()');
    responsiveConditionReady = document.querySelector("#brandingPlus") !== null;
    if (responsiveConditionReady) {
        imHbbrandingplus();
    }else{
//        console.log('ID: brandingPlus >> NOT found: ' + responsiveConditionReady);
//        console.log('imHbbrandingplusCount: '+ imHbbrandingplusCount);  
        imHbbrandingplusCount = imHbbrandingplusCount + 1;
        if(imHbbrandingplusCount < 20){
            setTimeout(function(){ imHbbrandingplusFire(); }, 100);            
        }
    }
} 
imHbbrandingplusFire(); 



if('brandingPlus'=='brandingPlus'){
    console.log('brandingPlus==brandingPlus');
//    responsiveConditionReady = document.querySelector(".box-imHbBrandingRam") !== null;                
//    if (responsiveConditionReady) {
//        console.log('1c body > .box-imHbBrandingRam fire remove');
//        document.querySelector("body > .box-imHbBrandingRam").remove();
//    }    
    var imHbBrandigDiv = document.createElement('div');
    imHbBrandigDiv.className = 'box-imHbBrandingRam';    
    imHbBrandigDiv.innerHTML = '<div class="imHbBrandingRam fcNewBrandingPlus" style="position: absolute; width: 100%; height: auto; z-index: 0; min-height: 0px;"><div id="brandingPlus" class="imHbBrandingPlus" style="width: 2000px; min-height: 0px; height: auto;overflow: visible;top: 0px;position: fixed; z-index: 0;left: 50%;margin-left: -1000px;display: block;pointer-events: auto !important;"></div></div>';
    document.body.insertBefore(imHbBrandigDiv, document.body.childNodes[0]);    
    setTimeout(function(){    
        var loadedBrandingPlus = document.getElementById('brandingPlus');
        loadedBrandingPlus.addEventListener("DOMNodeInserted", function (e) {
            console.log('brandingPlus DOMNodeInserted');

            var iframeLoadedBrandingPlus = document.querySelector("#brandingPlus div iframe");
            if(iframeLoadedBrandingPlus){
                console.log('iframeLoadedBrandingPlus >> DOMNodeInserted >> iframe');
                  var x = top.document.body;
                if (!x.classList.contains("imHbBranding")) {
                        x.classList.add("imHbBranding");
                }
                console.log('x.classList: '+x.classList);

                if('adform_leaderboard'!=''){
                    responsiveConditionReady = document.querySelector("#adform_leaderboard") !== null;
                    if (responsiveConditionReady) {
                        console.log('responsiveConditionReady >> removeDivId: adform_leaderboard');
//verze branding = slepÃ¡ kolej
                        document.querySelector("#adform_leaderboard").remove();
//verze branding = poskakuje pri zmene z leaderboardu 
//                        var removeDivIdObject = document.querySelector("#adform_leaderboard");
//                        removeDivIdObject.innerHTML = '';
//                        removeDivIdObject.style.height = 'auto';
//                        removeDivIdObject.style.minHeight = '0px';                            
                    }
                }            
                iframeLoadedBrandingPlus.onload = function() {
                
                    responsiveConditionReady = document.querySelector("#old-brandingPlus") !== null;                
                    if (responsiveConditionReady) {
                        console.log('#old-brandingPlus fire remove');
                        document.querySelector("#old-brandingPlus").closest(".box-imHbBrandingRam").remove();
                    }

                    if('adform_leaderboard'!=''){
                        responsiveConditionReady = document.querySelector("#adform_leaderboard") !== null;
                        if (responsiveConditionReady) {
                            console.log('responsiveConditionReady >> removeDivId: adform_leaderboard');
//verze branding = slepÃ¡ kolej
                            document.querySelector("#adform_leaderboard").remove();
//verze branding = poskakuje pri zmene z leaderboardu 
//                            var removeDivIdObject = document.querySelector("#adform_leaderboard");
//                            removeDivIdObject.innerHTML = '';
//                            removeDivIdObject.style.height = 'auto';
//                            removeDivIdObject.style.minHeight = '0px';                                
                        }
                    }
                }
            }                   
        }, false);
    }, 100);        
}

        
        
function imHbadform_leaderboard(){
    console.log('ID: adform_leaderboard >> OK: ' + responsiveConditionReady); 
    responsiveConditionReady = document.querySelector("#adform_leaderboard").innerHTML;            
    if(responsiveConditionReady == ''){
        console.log('Content in ID: adform_leaderboard is empty');
    }else{
        console.log('Fire remove content in ID: adform_leaderboard >> HTML: '+ responsiveConditionReady); 
        document.querySelector("#adform_leaderboard").innerHTML = '';            
    }        
}
var imHbadform_leaderboardCount = 0;
function imHbadform_leaderboardFire(){
//    console.log('Fire fc imHbadform_leaderboardFire()');
    responsiveConditionReady = document.querySelector("#adform_leaderboard") !== null;
    if (responsiveConditionReady) {
        imHbadform_leaderboard();
    }else{
//        console.log('ID: adform_leaderboard >> NOT found: ' + responsiveConditionReady);
//        console.log('imHbadform_leaderboardCount: '+ imHbadform_leaderboardCount);  
        imHbadform_leaderboardCount = imHbadform_leaderboardCount + 1;
        if(imHbadform_leaderboardCount < 20){
            setTimeout(function(){ imHbadform_leaderboardFire(); }, 100);            
        }
    }
} 
imHbadform_leaderboardFire(); 

        
function imHbadform_square(){
    console.log('ID: adform_square >> OK: ' + responsiveConditionReady); 
    responsiveConditionReady = document.querySelector("#adform_square").innerHTML;            
    if(responsiveConditionReady == ''){
        console.log('Content in ID: adform_square is empty');
    }else{
        console.log('Fire remove content in ID: adform_square >> HTML: '+ responsiveConditionReady); 
        document.querySelector("#adform_square").innerHTML = '';            
    }        
}
var imHbadform_squareCount = 0;
function imHbadform_squareFire(){
//    console.log('Fire fc imHbadform_squareFire()');
    responsiveConditionReady = document.querySelector("#adform_square") !== null;
    if (responsiveConditionReady) {
        imHbadform_square();
    }else{
//        console.log('ID: adform_square >> NOT found: ' + responsiveConditionReady);
//        console.log('imHbadform_squareCount: '+ imHbadform_squareCount);  
        imHbadform_squareCount = imHbadform_squareCount + 1;
        if(imHbadform_squareCount < 20){
            setTimeout(function(){ imHbadform_squareFire(); }, 100);            
        }
    }
} 
imHbadform_squareFire(); 

    



(function(window, document, pbjs, googletag) {
'use strict';

if (typeof(hbManager) !== 'undefined') return;

var PREBID_TIMEOUT = 2500; // ms
var FAILSAFE_TIMEOUT = 2500; // ms
var REFRESH_ONRESIZE = false;
var DFP_PAGEURL = "";
var DFP_SRA = false;
var YBCI = false;
var YBCI_DOMAIN = "";
var YBCI_ID = "";
var APS = false;
var APS_PUBID = "";
var placementFloor = {};

var imHbWindowWidth = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);
var hbPlacement;


//var adUnits = [
var adUnits = [];

// 1. --------------------------------
// Web Variableexclude#@##@#
// without setting for Web Variable
console.log('no Web Variable');
// 2. --------------------------------
// URL condition:include#@#regex#@#.*            
var patt = new RegExp('.*');
var urlCondition = patt.test(location.pathname);
if(urlCondition){

// 3. --------------------------------
// unitResponzivita:branding
  if((imHbWindowWidth >= 1200)){
    console.log('Responzivita = TRUE >> Placement brandingPlus / imHbWindowWidth: (' + imHbWindowWidth + ')');
    var check914358 = document.querySelector("#brandingPlus") !== null;
    console.log('ID: brandingPlus / check914358: ' + check914358);

// 4. --------------------------------
// unitAutoDivIdControl:0

placementFloor['brandingPlus'] = '0.00';
adUnits.push(
                                       // if unitStavRP = 1
    {
    "hbm_zone": {
        "userid": 1,
        "websiteid": 1733,
        "zoneid": 914358,                                                              //id
        "lazy_loading": 0,                                           //unitLazyLoading
        "lazy_loading_offset": 100,                                     //unitLazyPixelu
        "refresh": 0,                                 //unitAutoRefreshNumber if(unitAutoRefresh==0)>>0
        "refresh_limit": 3,                                    //unitAutoRefreshLimit            
        "nontracked": 0,                                             //unitSizeMapping
        "outofpage": 0,                                            //unitMinimalScreen
        "slot_code": "/96856532/TT-Pisnicky-Akordy-Branding-2000-1400-GAM",                 //unitSlotGAD
        "slot_sizes": [                                           //unitBannerSize
                [
                    2000,                                          //unitBannerSize
                    1400                                           //unitBannerSize
                ],
            ]
        },
        "code": "brandingPlus",

        "mediaTypes": {
            "banner": {
                "sizes": [ //unitBannerSize
                        [
                            2000,                                          //unitBannerSize
                            1400                                           //unitBannerSize
                        ]
                ]
            }
        },
        "labelAny": ["branding"],
        "bids": [
                                                              //explode paramsAllBidders (bidders) 
            {                                                 //paramsAllBidders [;;;]
                "bidder": "cpex-tt",
                "labelAny": ["branding"],        
                    "params": {
                               accountId: 10900,                        //int (cpex-tt >> accountId) // paramsAllBidders [@@@][::]
                               siteId: 142998,                        //int (cpex-tt >> siteId) // paramsAllBidders [@@@][::]
                               zoneId: 1103608,                        //int (cpex-tt >> zoneId) // paramsAllBidders [@@@][::]    
                    }                
            },                                                  //explode paramsAllBidders (bidders) 
            {                                                 //paramsAllBidders [;;;]
                "bidder": "adform-im-tt",
                "labelAny": ["branding"],        
                    "params": {
                               mid: 828463,                        //int cislaOstatni // paramsAllBidders [@@@][::]    
                    }                
            },                                                  //explode paramsAllBidders (bidders) 
            {                                                 //paramsAllBidders [;;;]
                "bidder": "adform-im-nt",
                "labelAny": ["branding"],        
                    "params": {
                               mid: 828464,                        //int cislaOstatni // paramsAllBidders [@@@][::]    
                    }                
            }
        ]
    }
); //end push    

}else{
    console.log('Responzivita = FALSE >> Placement brandingPlus / imHbWindowWidth: (' + imHbWindowWidth + ')');
    var check914358 = document.querySelector("#brandingPlus") !== null;
    console.log('ID: brandingPlus / check914358: ' + check914358);

  }

}else{
    console.log('URL condition >>  include / typ regex / string: .*');
}

// 1. --------------------------------
// Web Variableexclude#@##@#
// without setting for Web Variable
console.log('no Web Variable');
// 2. --------------------------------
// URL condition:include#@#regex#@#
// without setting for URL condition
console.log('no URL condition');
// 3. --------------------------------
// unitResponzivita:All
  if(((imHbWindowWidth >= 1) && (imHbWindowWidth <= 9999))){
    console.log('Responzivita = TRUE >> Placement adform_square / imHbWindowWidth: (' + imHbWindowWidth + ')');
    var check914360 = document.querySelector("#adform_square") !== null;
    console.log('ID: adform_square / check914360: ' + check914360);

// 4. --------------------------------
// unitAutoDivIdControl:0

placementFloor['adformsquare'] = '0.00';
adUnits.push(
                                       // if unitStavRP = 1
    {
    "hbm_zone": {
        "userid": 1,
        "websiteid": 1733,
        "zoneid": 914360,                                                              //id
        "lazy_loading": 0,                                           //unitLazyLoading
        "lazy_loading_offset": 0,                                     //unitLazyPixelu
        "refresh": 0,                                 //unitAutoRefreshNumber if(unitAutoRefresh==0)>>0
        "refresh_limit": 3,                                    //unitAutoRefreshLimit            
        "nontracked": 0,                                             //unitSizeMapping
        "outofpage": 0,                                            //unitMinimalScreen
        "slot_code": "/96856532/TT-Pisnicky-akordy-CW-Square-300-600-GAM",                 //unitSlotGAD
        "slot_sizes": [                                           //unitBannerSize
                [
                    300,                                          //unitBannerSize
                    600                                           //unitBannerSize
                ],
                [
                    300,                                          //unitBannerSize
                    250                                           //unitBannerSize
                ],
                [
                    120,                                          //unitBannerSize
                    600                                           //unitBannerSize
                ],
                [
                    160,                                          //unitBannerSize
                    600                                           //unitBannerSize
                ],
                [
                    250,                                          //unitBannerSize
                    250                                           //unitBannerSize
                ],
                [
                    200,                                          //unitBannerSize
                    200                                           //unitBannerSize
                ],
                [
                    300,                                          //unitBannerSize
                    300                                           //unitBannerSize
                ],
            ]
        },
        "code": "adform_square",

        "mediaTypes": {
            "banner": {
                "sizes": [ //unitBannerSize
                        [
                            300,                                          //unitBannerSize
                            600                                           //unitBannerSize
                        ],
                        [
                            300,                                          //unitBannerSize
                            250                                           //unitBannerSize
                        ],
                        [
                            120,                                          //unitBannerSize
                            600                                           //unitBannerSize
                        ],
                        [
                            160,                                          //unitBannerSize
                            600                                           //unitBannerSize
                        ],
                        [
                            250,                                          //unitBannerSize
                            250                                           //unitBannerSize
                        ],
                        [
                            200,                                          //unitBannerSize
                            200                                           //unitBannerSize
                        ],
                        [
                            300,                                          //unitBannerSize
                            300                                           //unitBannerSize
                        ]
                ]
            }
        },
        "labelAny": ["all"],
        "bids": [
                                                              //explode paramsAllBidders (bidders) 
            {                                                 //paramsAllBidders [;;;]
                "bidder": "cpex-tt",
                "labelAny": ["all"],        
                    "params": {
                               accountId: 10900,                        //int (cpex-tt >> accountId) // paramsAllBidders [@@@][::]
                               siteId: 142998,                        //int (cpex-tt >> siteId) // paramsAllBidders [@@@][::]
                               zoneId: 1449604,                        //int (cpex-tt >> zoneId) // paramsAllBidders [@@@][::]    
                    }                
            },                                                  //explode paramsAllBidders (bidders) 
            {                                                 //paramsAllBidders [;;;]
                "bidder": "criteo-im",
                "labelAny": ["all"],        
                    "params": {
                               networkId: 7456,                        //int (criteo-im >> networkId) // paramsAllBidders [@@@][::]
                               publisherSubId: "pisnicky-akordy/Square_300x600_674825",                        //varchar (criteo-im >> publisherSubId) // paramsAllBidders [@@@][::]    
                    }                
            },                                                  //explode paramsAllBidders (bidders) 
            {                                                 //paramsAllBidders [;;;]
                "bidder": "adform-im-tt",
                "labelAny": ["all"],        
                    "params": {
                               mid: 674825,                        //int cislaOstatni // paramsAllBidders [@@@][::]    
                    }                
            },                                                  //explode paramsAllBidders (bidders) 
            {                                                 //paramsAllBidders [;;;]
                "bidder": "cpex-nt",
                "labelAny": ["all"],        
                    "params": {
                               accountId: 10900,                        //int (cpex-nt >> accountId) // paramsAllBidders [@@@][::]
                               siteId: 143000,                        //int (cpex-nt >> siteId) // paramsAllBidders [@@@][::]
                               zoneId: 1449606,                        //int (cpex-nt >> zoneId) // paramsAllBidders [@@@][::]    
                    }                
            },                                                  //explode paramsAllBidders (bidders) 
            {                                                 //paramsAllBidders [;;;]
                "bidder": "adform-im-nt",
                "labelAny": ["all"],        
                    "params": {
                               mid: 674827,                        //int cislaOstatni // paramsAllBidders [@@@][::]    
                    }                
            },                                                  //explode paramsAllBidders (bidders) 
            {                                                 //paramsAllBidders [;;;]
                "bidder": "appnexus-cpex",
                "labelAny": ["all"],        
                    "params": {
                               placementId: "17331044",                        //varchar cislaOstatni // paramsAllBidders [@@@][::]    
                    }                
            },                                                  //explode paramsAllBidders (bidders) 
            {                                                 //paramsAllBidders [;;;]
                "bidder": "pubmatic-cpex",
                "labelAny": ["all"],        
                    "params": {
                               publisherId: "158732",                        //varchar cislaOstatni // paramsAllBidders [@@@][::]
                               adSlot: "3121232",                        //varchar cislaOstatni // paramsAllBidders [@@@][::]
                               currency: "USD",                        //varchar cislaOstatni // paramsAllBidders [@@@][::]    
                    }                
            },                                                  //explode paramsAllBidders (bidders) 
            {                                                 //paramsAllBidders [;;;]
                "bidder": "Teads",
                "labelAny": ["all"],        
                    "params": {
                               pageId: "196350",                        //varchar cislaOstatni // paramsAllBidders [@@@][::]
                               placementId: "211914",                        //varchar cislaOstatni // paramsAllBidders [@@@][::]    
                    }                
            },                                                  //explode paramsAllBidders (bidders) 
            {                                                 //paramsAllBidders [;;;]
                "bidder": "adform-omd",
                "labelAny": ["all"],        
                    "params": {
                               mid: 1183275,                        //int cislaOstatni // paramsAllBidders [@@@][::]    
                    }                
            },                                                  //explode paramsAllBidders (bidders) 
            {                                                 //paramsAllBidders [;;;]
                "bidder": "appnexus-im",
                "labelAny": ["all"],        
                    "params": {
                               placementId: "27363283",                        //varchar cislaOstatni // paramsAllBidders [@@@][::]    
                    }                
            },                                                  //explode paramsAllBidders (bidders) 
            {                                                 //paramsAllBidders [;;;]
                "bidder": "adform-fragile",
                "labelAny": ["all"],        
                    "params": {
                               mid: 1593442,                        //int cislaOstatni // paramsAllBidders [@@@][::]    
                    }                
            },                                                  //explode paramsAllBidders (bidders) 
            {                                                 //paramsAllBidders [;;;]
                "bidder": "adform-sasAll",
                "labelAny": ["all"],        
                    "params": {
                               mid: 1828120,                        //int cislaOstatni // paramsAllBidders [@@@][::]
                               sasArea: "halfpagead-1",                        //varchar cislaOstatni // paramsAllBidders [@@@][::]
                               sasSite: "IMM_Auta",                        //varchar cislaOstatni // paramsAllBidders [@@@][::]
                               sasSize: "300x600,300x300,300x250,120x600,160x600",                        //varchar cislaOstatni // paramsAllBidders [@@@][::]
                               sasMapping: "halfpage",                        //varchar cislaOstatni // paramsAllBidders [@@@][::]
                               sasCPM: "0.66",                        //varchar cislaOstatni // paramsAllBidders [@@@][::]    
                    }                
            }
        ]
    }
); //end push    

}else{
    console.log('Responzivita = FALSE >> Placement adform_square / imHbWindowWidth: (' + imHbWindowWidth + ')');
    var check914360 = document.querySelector("#adform_square") !== null;
    console.log('ID: adform_square / check914360: ' + check914360);

  }

// 1. --------------------------------
// Web Variableexclude#@##@#
// without setting for Web Variable
console.log('no Web Variable');
// 2. --------------------------------
// URL condition:include#@#regex#@#
// without setting for URL condition
console.log('no URL condition');
// 3. --------------------------------
// unitResponzivita:desktop
  if((imHbWindowWidth >= 1000)){
    console.log('Responzivita = TRUE >> Placement adform_leaderboard / imHbWindowWidth: (' + imHbWindowWidth + ')');
    var check914359 = document.querySelector("#adform_leaderboard") !== null;
    console.log('ID: adform_leaderboard / check914359: ' + check914359);

// 4. --------------------------------
// unitAutoDivIdControl:0

placementFloor['adformleaderboard'] = '0.00';
adUnits.push(
                                       // if unitStavRP = 1
    {
    "hbm_zone": {
        "userid": 1,
        "websiteid": 1733,
        "zoneid": 914359,                                                              //id
        "lazy_loading": 0,                                           //unitLazyLoading
        "lazy_loading_offset": 0,                                     //unitLazyPixelu
        "refresh": 0,                                 //unitAutoRefreshNumber if(unitAutoRefresh==0)>>0
        "refresh_limit": 3,                                    //unitAutoRefreshLimit            
        "nontracked": 0,                                             //unitSizeMapping
        "outofpage": 0,                                            //unitMinimalScreen
        "slot_code": "/96856532/TT-Pisnicky-akordy-CW-Leaderboard-1000-200-GAM",                 //unitSlotGAD
        "slot_sizes": [                                           //unitBannerSize
                [
                    728,                                          //unitBannerSize
                    90                                           //unitBannerSize
                ],
                [
                    970,                                          //unitBannerSize
                    100                                           //unitBannerSize
                ],
                [
                    970,                                          //unitBannerSize
                    90                                           //unitBannerSize
                ],
                [
                    970,                                          //unitBannerSize
                    210                                           //unitBannerSize
                ],
                [
                    1000,                                          //unitBannerSize
                    200                                           //unitBannerSize
                ],
                [
                    745,                                          //unitBannerSize
                    200                                           //unitBannerSize
                ],
                [
                    745,                                          //unitBannerSize
                    100                                           //unitBannerSize
                ],
                [
                    970,                                          //unitBannerSize
                    200                                           //unitBannerSize
                ],
                [
                    970,                                          //unitBannerSize
                    120                                           //unitBannerSize
                ],
                [
                    1000,                                          //unitBannerSize
                    100                                           //unitBannerSize
                ],
                [
                    980,                                          //unitBannerSize
                    100                                           //unitBannerSize
                ],
                [
                    980,                                          //unitBannerSize
                    200                                           //unitBannerSize
                ],
                [
                    980,                                          //unitBannerSize
                    120                                           //unitBannerSize
                ],
                [
                    728,                                          //unitBannerSize
                    90                                           //unitBannerSize
                ],
                [
                    998,                                          //unitBannerSize
                    200                                           //unitBannerSize
                ],
                [
                    990,                                          //unitBannerSize
                    100                                           //unitBannerSize
                ],
                [
                    750,                                          //unitBannerSize
                    200                                           //unitBannerSize
                ],
                [
                    750,                                          //unitBannerSize
                    100                                           //unitBannerSize
                ],
            ]
        },
        "code": "adform_leaderboard",

        "mediaTypes": {
            "banner": {
                "sizes": [ //unitBannerSize
                        [
                            728,                                          //unitBannerSize
                            90                                           //unitBannerSize
                        ],
                        [
                            970,                                          //unitBannerSize
                            100                                           //unitBannerSize
                        ],
                        [
                            970,                                          //unitBannerSize
                            90                                           //unitBannerSize
                        ],
                        [
                            970,                                          //unitBannerSize
                            210                                           //unitBannerSize
                        ],
                        [
                            1000,                                          //unitBannerSize
                            200                                           //unitBannerSize
                        ],
                        [
                            745,                                          //unitBannerSize
                            200                                           //unitBannerSize
                        ],
                        [
                            745,                                          //unitBannerSize
                            100                                           //unitBannerSize
                        ],
                        [
                            970,                                          //unitBannerSize
                            200                                           //unitBannerSize
                        ],
                        [
                            970,                                          //unitBannerSize
                            120                                           //unitBannerSize
                        ],
                        [
                            1000,                                          //unitBannerSize
                            100                                           //unitBannerSize
                        ],
                        [
                            980,                                          //unitBannerSize
                            100                                           //unitBannerSize
                        ],
                        [
                            980,                                          //unitBannerSize
                            200                                           //unitBannerSize
                        ],
                        [
                            980,                                          //unitBannerSize
                            120                                           //unitBannerSize
                        ],
                        [
                            728,                                          //unitBannerSize
                            90                                           //unitBannerSize
                        ],
                        [
                            998,                                          //unitBannerSize
                            200                                           //unitBannerSize
                        ],
                        [
                            990,                                          //unitBannerSize
                            100                                           //unitBannerSize
                        ],
                        [
                            750,                                          //unitBannerSize
                            200                                           //unitBannerSize
                        ],
                        [
                            750,                                          //unitBannerSize
                            100                                           //unitBannerSize
                        ]
                ]
            }
        },
        "labelAny": ["desktop"],
        "bids": [
                                                              //explode paramsAllBidders (bidders) 
            {                                                 //paramsAllBidders [;;;]
                "bidder": "cpex-tt",
                "labelAny": ["desktop"],        
                    "params": {
                               accountId: 10900,                        //int (cpex-tt >> accountId) // paramsAllBidders [@@@][::]
                               siteId: 142998,                        //int (cpex-tt >> siteId) // paramsAllBidders [@@@][::]
                               zoneId: 1103608,                        //int (cpex-tt >> zoneId) // paramsAllBidders [@@@][::]    
                    }                
            },                                                  //explode paramsAllBidders (bidders) 
            {                                                 //paramsAllBidders [;;;]
                "bidder": "criteo-im",
                "labelAny": ["desktop"],        
                    "params": {
                               networkId: 7456,                        //int (criteo-im >> networkId) // paramsAllBidders [@@@][::]
                               publisherSubId: "pisnicky-akordy/Leaderboard_617203",                        //varchar (criteo-im >> publisherSubId) // paramsAllBidders [@@@][::]    
                    }                
            },                                                  //explode paramsAllBidders (bidders) 
            {                                                 //paramsAllBidders [;;;]
                "bidder": "adform-im-tt",
                "labelAny": ["desktop"],        
                    "params": {
                               mid: 617203,                        //int cislaOstatni // paramsAllBidders [@@@][::]    
                    }                
            },                                                  //explode paramsAllBidders (bidders) 
            {                                                 //paramsAllBidders [;;;]
                "bidder": "cpex-nt",
                "labelAny": ["desktop"],        
                    "params": {
                               accountId: 10900,                        //int (cpex-nt >> accountId) // paramsAllBidders [@@@][::]
                               siteId: 143000,                        //int (cpex-nt >> siteId) // paramsAllBidders [@@@][::]
                               zoneId: 1103610,                        //int (cpex-nt >> zoneId) // paramsAllBidders [@@@][::]    
                    }                
            },                                                  //explode paramsAllBidders (bidders) 
            {                                                 //paramsAllBidders [;;;]
                "bidder": "adform-im-nt",
                "labelAny": ["desktop"],        
                    "params": {
                               mid: 617206,                        //int cislaOstatni // paramsAllBidders [@@@][::]    
                    }                
            },                                                  //explode paramsAllBidders (bidders) 
            {                                                 //paramsAllBidders [;;;]
                "bidder": "pubmatic-cpex",
                "labelAny": ["desktop"],        
                    "params": {
                               publisherId: "158732",                        //varchar cislaOstatni // paramsAllBidders [@@@][::]
                               adSlot: "3121231",                        //varchar cislaOstatni // paramsAllBidders [@@@][::]
                               currency: "USD",                        //varchar cislaOstatni // paramsAllBidders [@@@][::]    
                    }                
            },                                                  //explode paramsAllBidders (bidders) 
            {                                                 //paramsAllBidders [;;;]
                "bidder": "adform-omd",
                "labelAny": ["desktop"],        
                    "params": {
                               mid: 1183274,                        //int cislaOstatni // paramsAllBidders [@@@][::]    
                    }                
            },                                                  //explode paramsAllBidders (bidders) 
            {                                                 //paramsAllBidders [;;;]
                "bidder": "appnexus-im",
                "labelAny": ["desktop"],        
                    "params": {
                               placementId: "27363273",                        //varchar cislaOstatni // paramsAllBidders [@@@][::]    
                    }                
            },                                                  //explode paramsAllBidders (bidders) 
            {                                                 //paramsAllBidders [;;;]
                "bidder": "adform-fragile",
                "labelAny": ["desktop"],        
                    "params": {
                               mid: 1593441,                        //int cislaOstatni // paramsAllBidders [@@@][::]    
                    }                
            }
        ]
    }
); //end push    

}else{
    console.log('Responzivita = FALSE >> Placement adform_leaderboard / imHbWindowWidth: (' + imHbWindowWidth + ')');
    var check914359 = document.querySelector("#adform_leaderboard") !== null;
    console.log('ID: adform_leaderboard / check914359: ' + check914359);

  }

//];


    var customPriceGranularity = {  //musi byt v dolarech
        "buckets": [
                {
                'precision': 2,
                'max': 0.434781085,
                'increment': 0.0869565217
            },
            {
                'precision': 2,                    
                'max': 1.3043463,
                'increment': 0.173913043
            },
            {
                'precision': 2,                    
                'max': 5.21738978,
                'increment': 0.652173913
            }
        ]
    };    
    

var adConfig = {
       "priceGranularity": customPriceGranularity,
//    "priceGranularity": "custom",
//    "mediaTypePriceGranularity": {
//          'video': customPriceGranularity,
//	  'video-outstream': customPriceGranularity,
//          'banner': customPriceGranularity,
//          'native': customPriceGranularity,
//        },
    "currency": {
        "adServerCurrency": "CZK",                                        //gamCurrency
        "granularityMultiplier": 23                               //nasobitelGranularity
    },
    cache: {
        url: "https://prebid.adnxs.com/pbc/v1/cache"
    },   
    
       sizeConfig: [{
                       "mediaQuery": '(min-width: 1200px)',  
                        "labels": [ "branding"]
                    }, 
                {
                       "mediaQuery": '(max-width: 767px)',  
                        "labels": [ "mobil"]
                    }, 
                {
                       "mediaQuery": '(min-width: 1000px)',  
                        "labels": [ "desktop"]
                    }, 
                {
                       "mediaQuery": '(min-width: 768px) and (max-width: 1199px)', 
                        "labels": [ "tablet"]
                    }, 
                {
                       "mediaQuery": '(min-width: 1px) and (max-width: 9999px)', 
                        "labels": [ "all"]
                    }, 
                ],
        
    "enableSendAllBids": false,                                   //zatim fix >> GAM API + http://prebid.org/dev-docs/publisher-api-reference.html#setConfig-Send-All-Bids

    "publisherDomain": "https://pisnicky-akordy.cz",                 //http://prebid.org/sandbox/prebid-api-guide.html?apiDocTarget=configuration&apiDefinition=publisherDomain#apiDocs

    "maxRequestsPerOrigin": 4,                                //http://prebid.org/dev-docs/publisher-api-reference.html#setConfig-Max-Requests-Per-Origin

        userIds:[
            {name: 'sharedId',
                storage: {
                    name: '_sharedID',
                    type: 'cookie',
                    expires: 30
                }
            },
            {name:'criteo'}
        ]
    
}; //end adConfig

if (APS) {
	!function(a9,a,p,s,t,A,g){if(a[a9])return;function q(c,r){a[a9]._Q.push([c,r])}a[a9]={init:function(){q("i",arguments)},fetchBids:function(){q("f",arguments)},setDisplayBids:function(){},targetingKeys:function(){return[]},_Q:[]};A=p.createElement(s);A.async=!0;A.src=t;g=p.getElementsByTagName(s)[0];g.parentNode.insertBefore(A,g)}("apstag",window,document,"script","//c.amazon-adsystem.com/aax2/apstag.js");
}

(function () {
	if ('IntersectionObserver' in window &&
		'IntersectionObserverEntry' in window &&
		'intersectionRatio' in window.IntersectionObserverEntry.prototype) return;
	var plf = document.createElement('script');
	plf.type = 'text/javascript';
	plf.async = true;
	plf.src = '//hb-testing.progsol.cz/prebid/polyfill.min.js';                                //bez zaruky >> nastaveni dle vzoru
	var target = document.getElementsByTagName('head')[0];
	target.insertBefore(plf, target.firstChild);
	window.hbm_polyfill = plf;
})();


if (YBCI) {                                                                                         //zatim false viz radek c.55
	window.yb_configuration = {"domain": YBCI_DOMAIN, "lazyLoad": true};
	(function (y, i, e, l, d, b, I, R, D) {
		d.Yieldbird = d.Yieldbird || {};
		d.Yieldbird.cmd = d.Yieldbird.cmd || [];
		l.cmd.push(function () {l.pubads().disableInitialLoad();});
		b = i.createElement('script'); b.async = true;
		b.src = (e === 'https:' ? 'https:' : 'http:') + '//jscdn.yieldbird.com/' + y + '/yb.js';            
		I = i.getElementsByTagName('script')[0];
		(I.parentNode || i.head).insertBefore(b, I);
	})(YBCI_ID, document, document.location.protocol, googletag, window);
}

// start escape !!
// ---------------------------------------------------------------------------------------------------------------------
// ---------------------------------------------------------------------------------------------------------------------
// ---------------------------------------------------------------------------------------------------------------------



//pbjs.onEvent('bidAdjustment', function(data){
//        console.log('bidAdjustment^^');
//        console.log(data);
//        if(data.bidderCode == 'adform-sasAll'){
//            data.ad = '<h2>test bidAdjustment test bidAdjustment test bidAdjustment</h2>';
//            console.log('adform-sasAll bidAdjustment^^');
//            console.log(data);
//        }
//});

function getCpm(bidCpm, bid, pubshare, floor) {

//if(bid.bidder == 'adform-sasAll'){
//        console.log('getCpm >> bid^^');
//        console.log(bid); 
//        bid.cpm = 120;
//        bid.originalCpm = 120;
//        bidCpm = 120;
//        bid.ad = '<h2>test text test text text test text test text text test text test text test text</h2>';
//        console.log('pbjs^^');
//        console.log(pbjs); 
////        var s = pbjs.getHighestCpmBids();
////        console.log('s^^');
////        console.log(s);
//}


	console.log('getCpm >> ('+bid.bidder+') >> bidCpm: ' + bidCpm);
	console.log('getCpm >> ('+bid.bidder+') >> bid ^^');
	console.log(bid);
        console.log('getCpm >> ('+bid.bidder+') >> pubshare: ' + pubshare);
        console.log('getCpm >> ('+bid.bidder+') >> floor: ' + floor);        
//        if(bid.currency != bid.originalCurrency){
//            var cpmInCZK = (typeof bid.getCpmInNewCurrency === "function") ? bid.getCpmInNewCurrency('CZK') : bid.originalCpm;
//        }else{
            if(bid.currency != 'CZK'){
                console.log('bid.currency != CZK ' + bid.currency);
                var cpmInCZK = bid.cpm * 23;
                    bidCpm = cpmInCZK;
            }else{
                var cpmInCZK = bid.cpm;
            }
//        }
	
        
        console.log('getCpm >> ('+bid.bidder+') >> cpmInCZK: ' + cpmInCZK);
        
        console.log('getCpm >> ('+bid.bidder+') >> bid.currency: ' + bid.currency);
        console.log('getCpm >> ('+bid.bidder+') >> bid.originalCurrency: ' + bid.originalCurrency);        
        console.log('getCpm >> ('+bid.bidder+') >> --------------------------------------------------------- ');
        console.log('getCpm >> ('+bid.bidder+') >> cpmInCZK * pubshare = ' + (cpmInCZK * pubshare));
        console.log('getCpm >> ('+bid.bidder+') >> floor:' + floor);

        if(placementFloor[bid.adUnitCode.replace(/-|_/g, "")]>0){
           floor = placementFloor[bid.adUnitCode.replace(/-|_/g, "")];
           console.log('getCpm >> ('+bid.adUnitCode.replace(/-|_/g, "")+') >> placementFloor:' + floor);           
        }


        if(cpmInCZK * pubshare < floor){
            console.log('getCpm >> ('+bid.bidder+') >> if (cpmInCZK * pubshare < floor) ');
            console.log('getCpm >> ('+bid.bidder+') >> cpm is: 0');        
            return 0;
	}else{
            console.log('getCpm >> ('+bid.bidder+') >> if (cpmInCZK * pubshare < floor) ');
            console.log('getCpm >> ('+bid.bidder+') >> bidCpm * pubshare: ' + (bidCpm * pubshare));
        }
	return bidCpm * pubshare; 
}




function getBidderCode(bidderCode) {
	if (adBidders && adBidders[bidderCode]) {
		bidderCode += ',' + adBidders[bidderCode];
	}
	return bidderCode; 
}


// ---------------------------------------------------------------------------------------------------------------------
// ---------------------------------------------------------------------------------------------------------------------
// ---------------------------------------------------------------------------------------------------------------------

pbjs.setConfig(adConfig);

pbjs.que.push(function() {
	pbjs.bidderSettings = {
            "cpex-tt": { 
                bidCpmAdjustment: function(bidCpm, bid) { return getCpm(bidCpm, bid, 0.8, 3) }
            },
            "criteo-im": { 
                bidCpmAdjustment: function(bidCpm, bid) { return getCpm(bidCpm, bid, 1, 3) }
            },
            "adform-im-tt": { 
                bidCpmAdjustment: function(bidCpm, bid) { return getCpm(bidCpm, bid, 0.9, 3) }
            },
            "cpex-nt": { 
                bidCpmAdjustment: function(bidCpm, bid) { return getCpm(bidCpm, bid, 0.8, 3) }
            },
            "adform-im-nt": { 
                bidCpmAdjustment: function(bidCpm, bid) { return getCpm(bidCpm, bid, 0.8, 3) }
            },
            "r2b2": { 
                bidCpmAdjustment: function(bidCpm, bid) { return getCpm(bidCpm, bid, 0.8, 3) }
            },
            "mgid": { 
                bidCpmAdjustment: function(bidCpm, bid) { return getCpm(bidCpm, bid, 0.8, 3) }
            },
            "appnexus-cpex": { 
                bidCpmAdjustment: function(bidCpm, bid) { return getCpm(bidCpm, bid, 0.8, 3) }
            },
            "stroeerCore": { 
                bidCpmAdjustment: function(bidCpm, bid) { return getCpm(bidCpm, bid, 0.8, 3) }
            },
            "pubmatic-cpex": { 
                bidCpmAdjustment: function(bidCpm, bid) { return getCpm(bidCpm, bid, 0.8, 3) }
            },
            "Teads": { 
                bidCpmAdjustment: function(bidCpm, bid) { return getCpm(bidCpm, bid, 0.8, 3) }
            },
            "ix": { 
                bidCpmAdjustment: function(bidCpm, bid) { return getCpm(bidCpm, bid, 0.8, 3) }
            },
            "adform-omd": { 
                bidCpmAdjustment: function(bidCpm, bid) { return getCpm(bidCpm, bid, 0.7, 3) }
            },
            "rtbhouse": { 
                bidCpmAdjustment: function(bidCpm, bid) { return getCpm(bidCpm, bid, 0.8, 3) }
            },
            "pubmatic-im": { 
                bidCpmAdjustment: function(bidCpm, bid) { return getCpm(bidCpm, bid, 0.8, 3) }
            },
            "appnexus-im": { 
                bidCpmAdjustment: function(bidCpm, bid) { return getCpm(bidCpm, bid, 0.8, 3) }
            },
            "adform-fragile": { 
                bidCpmAdjustment: function(bidCpm, bid) { return getCpm(bidCpm, bid, 0.8, 3) }
            },
            "adform-eom-omd": { 
                bidCpmAdjustment: function(bidCpm, bid) { return getCpm(bidCpm, bid, 0.8, 3) }
            },
            "smilewanted-im": { 
                bidCpmAdjustment: function(bidCpm, bid) { return getCpm(bidCpm, bid, 0.8, 3) }
            },
            "adform-prima": { 
                bidCpmAdjustment: function(bidCpm, bid) { return getCpm(bidCpm, bid, 0.8, 10) }
            },
            "adform-sasAll": { 
                bidCpmAdjustment: function(bidCpm, bid) { return getCpm(bidCpm, bid, 0.8, 3) }
            },
            "adform-sasBranding": { 
                bidCpmAdjustment: function(bidCpm, bid) { return getCpm(bidCpm, bid, 0.8, 3) }
            },
            "iprima": { 
                bidCpmAdjustment: function(bidCpm, bid) { return getCpm(bidCpm, bid, 0.8, 10) }
            },
            
    };
    pbjs.addAdUnits(adUnits);
    pbjs.aliasBidder('rubicon', 'cpex-tt');
    pbjs.aliasBidder('criteo', 'criteo-im');
    pbjs.aliasBidder('adform', 'adform-im-tt');
    pbjs.aliasBidder('rubicon', 'cpex-nt');
    pbjs.aliasBidder('adform', 'adform-im-nt');
    pbjs.aliasBidder('appnexus', 'appnexus-cpex');
    pbjs.aliasBidder('pubmatic', 'pubmatic-cpex');
    pbjs.aliasBidder('teads', 'Teads');
    pbjs.aliasBidder('adform', 'adform-omd');
    pbjs.aliasBidder('pubmatic', 'pubmatic-im');
    pbjs.aliasBidder('appnexus', 'appnexus-im');
    pbjs.aliasBidder('adform', 'adform-fragile');
    pbjs.aliasBidder('adform', 'adform-eom-omd');
    pbjs.aliasBidder('adform', 'adform-prima');
    pbjs.aliasBidder('adform', 'adform-sasAll');
    pbjs.aliasBidder('adform', 'adform-sasBranding');
    


//statistika
function statisticsAuctionEnd(data, kam){
    console.log('fire post data auctionEnd: '+kam);
    console.log(data);
    if(typeof data === 'object'){
        if(data.ext){
            data.ext = null;
            console.log('fire data ext(R2B2)');
            console.log(data);
        }else{
            console.log('fire NO data ext(R2B2)');        
        }
    }
//    var strData = JSON.stringify(data);
    var strData = encodeURIComponent(JSON.stringify(data));    
    console.log('strData: '+strData);

    var hbmasterscript = 'hb-0';
    if(null != top.document.body.getAttribute("data-hbmasterscript")){
        hbmasterscript = top.document.body.getAttribute("data-hbmasterscript"); 
    }

    var xhr = new XMLHttpRequest();
    xhr.open('GET', 'https://hb.impressionmedia.cz/statistics/'+kam+'.php?configId=1733&statistics=0&groupBidsReceivedTable=5&groupRandId=3&hbmasterscript='+hbmasterscript+'&data='+strData);
//    xhr.setRequestHeader('Content-Type', 'application/json');
    xhr.onreadystatechange = function () {
      // In local files, status is 0 upon success in Mozilla Firefox
      if(xhr.readyState === XMLHttpRequest.DONE) {
        var status = xhr.status;
        if (status === 0 || (status >= 200 && status < 400)) {
          // The request has been completed successfully
          console.log('xhr.responseText');          
          console.log(status + ': ' + xhr.responseText);
        } else {
            console.log('error in xhr');
          // Oh no! There has been an error with the request!
        }
      }
    };
    xhr.send();

}

//	pbjs.onEvent('bidRequested', function(data){
//		for (var i in data.bids) {
//			var u = adUnits.filter(function(u) {
//				return u.code === data.bids[i].adUnitCode;
//			})[0];
//			if (!u) return;
//                        //if (!u.userId) u.userId = {};
//			//u.userId = {pubcid: 'test2'};
//			if (!u.hbm_stats) u.hbm_stats = [];
//			u.hbm_stats.push({
//				event: 'bidRequested',
//				v: 'v2',
//				user_id: u.hbm_zone.userid,
//				website_id: u.hbm_zone.websiteid,
//				zone_id: u.hbm_zone.zoneid,
//				bidderCode: getBidderCode(data.bids[i].bidder),
//				refresh: u.hbm_zone.isRefresh ? 't' : '',
//			});
//		}
//	});

	pbjs.onEvent('auctionInit', function(data){
		for (var i in data.adUnitCodes) {
			var u = adUnits.filter(function(u) {
				return u.code === data.adUnitCodes[i];
			})[0];
			if (!u) return;
                        //if (!u.userId) u.userId = {};
			//u.userId = {pubcid: 'test'};                        
			if (!u.hbm_stats) u.hbm_stats = [];
			u.hbm_stats.push({
				event: 'auctionInit',
				v: 'v2',
				user_id: u.hbm_zone.userid,
				website_id: u.hbm_zone.websiteid,
				zone_id: u.hbm_zone.zoneid,
				refresh: u.hbm_zone.isRefresh ? 't' : '',
			});
		}
	});


	pbjs.onEvent('bidWon', function(data){       
            console.log('pbjsonEvent >> bidWon^^'); 
            console.log(data);
            console.log('pbjsonEvent >> bidWon >> currency: ' + data.currency + ' // originalCurrency: ' +  data.originalCurrency );

            console.log('bidWon statisticsAuctionEnd: '+data.adUnitCode);
            
	});
	
});

//function sendStatistics(code) {}

googletag.cmd.push(function() {
	googletag.pubads().disableInitialLoad();
	googletag.pubads().addEventListener('slotOnload', function(event) {
		adUnits.filter(function(u) {
			return u.hbm_zone.slot === event.slot;
		}).forEach(function(u) {
			//sendStatistics(u.code);
		});
	});
	adUnits.forEach(function(u) {

		if (u.code) {
			if (u.hbm_zone.outofpage)
				u.hbm_zone.slot = googletag.defineOutOfPageSlot(u.hbm_zone.slot_code, u.code);
			else
				u.hbm_zone.slot = googletag.defineSlot(u.hbm_zone.slot_code, u.hbm_zone.slot_sizes, u.code);
			if (adMapping[u.hbm_zone.zoneid])
				u.hbm_zone.slot.defineSizeMapping(adMapping[u.hbm_zone.zoneid]);
			u.hbm_zone.slot.addService(googletag.pubads());
		}
	});
	if (DFP_PAGEURL !== '')
		googletag.pubads().set('page_url',DFP_PAGEURL);
	googletag.pubads().collapseEmptyDivs();
	googletag.pubads().setCentering(true);
	if (DFP_SRA)
		googletag.pubads().enableSingleRequest();
	googletag.enableServices();
});

if (APS) {
	apstag.init({
		pubID: APS_PUBID,
		adServer: 'googletag',
	});
}

pbjs.que.push(function () {

        var checkMediaQuery = [];  //jaja
        var checkUnitMediaQuery = '';  //jaja 

	var units = adUnits.filter(function(u) {
                console.log('-----------------------------------');
                console.log('u.labelAny: '+u.labelAny);
                console.log(u);  
                checkUnitMediaQuery = 'nonSet';  //jaja 


                if (u.labelAny[0]!='notResponzive'){    //jaja
                    if (u.labelAny.length == 1){
                        adConfig.sizeConfig.forEach(function(aSizeConfig){
                            if(aSizeConfig.labels[0]){
//                                console.log('aSizeConfig.labels[0]: '+aSizeConfig.labels[0]);
                            }else{
//                                console.log('Not set aSizeConfig.labels[0]');
                            }
                        
                            if(aSizeConfig.labels[0]==u.labelAny[0]){                            
//                              console.log('u.labelAny[0]'+u.labelAny[0]+'  vs aSizeConfig.mediaQuery'+aSizeConfig.mediaQuery );
                              var x = window.matchMedia(aSizeConfig.mediaQuery);      
                              if (x.matches) { 
//                                console.log('if x.matches');
//                                console.log('u.code: '+u.code);            
                                checkMediaQuery.push(u.code);
                                checkUnitMediaQuery = 'display';                                
                              } else {
//                                console.log('else x.matches');
//                                console.log('u.code: '+u.code); 
                                checkUnitMediaQuery = 'hidden'; 
                              }
                            }else{
//                                console.log('Jiny stitek >> u.labelAny[0]'+u.labelAny[0])
                            }
                        });
                    }else if(u.labelAny.length == 2){
                    
                        var arrCheckMediaQuery = [];

                        adConfig.sizeConfig.forEach(function(bSizeConfig){
                            if((bSizeConfig.labels[0]==u.labelAny[0])||(bSizeConfig.labels[0]==u.labelAny[1])){ 
                                arrCheckMediaQuery.push(bSizeConfig.mediaQuery);
                            }
                            
                        });

                        console.log('u.labelAny[0]: '+u.labelAny[0]+ ' and u.labelAny[1]: '+u.labelAny[1]);
                        var xa = window.matchMedia(arrCheckMediaQuery[0]);  
//                        console.log('arrCheckMediaQuery[0]: '+arrCheckMediaQuery[0] + '  and arrCheckMediaQuery[1]: '+arrCheckMediaQuery[1]);
                        var xb = window.matchMedia(arrCheckMediaQuery[1]);                         
                        if (xa.matches) { 
//                            console.log('if x.matches / '+arrCheckMediaQuery[0]);
//                            console.log('u.code: '+u.code);            
                            checkMediaQuery.push(u.code);
                            checkUnitMediaQuery = 'display';
                        }
                        else if (xb.matches) { 
//                            console.log('if x.matches / '+arrCheckMediaQuery[1]);
//                            console.log('u.code: '+u.code);            
                            checkMediaQuery.push(u.code);
                            checkUnitMediaQuery = 'display';
                        }
                        else {
//                            console.log('else x.matches');
//                            console.log('u.code: '+u.code);
                            checkUnitMediaQuery = 'hidden';
                        }

                    }else{ console.log('POZOR problem'); }
                }else{
                    console.log('NO PROBLEM - bez kontroly responzivity');
                    return u.code && !u.hbm_zone.lazy_loading;
                }

            if(checkUnitMediaQuery=='display'){
                return u.code && !u.hbm_zone.lazy_loading;
            }

	});

        
        
	if (units.length === 0) return;


        console.log('===========================');
        console.log(units);
	startAuction(units);
});


function removeA(arr) {
    var what, a = arguments, L = a.length, ax;
    while (L > 1 && arr.length) {
        what = a[--L];
        while ((ax= arr.indexOf(what)) !== -1) {
            arr.splice(ax, 1);
        }
    }
    return arr;
}

function sendAdserverRequests(codes) {


	var unitsForSend = adUnits.filter(function(u) {

		if (codes.indexOf(u.code) != -1 && u.hbm_zone.unitForSend && u.hbm_zone.back >= (1 + APS)) {
			u.hbm_zone.unitForSend = false;
			return true;
		}
		return false;
	});
	if (unitsForSend.length == 0) return;

	var codesForSend = unitsForSend.map(function(u) {
		return u.code;
	});

	var slots = unitsForSend.map(function(u) {
//        console.log('u^^');        
//        console.log(u);
                //u.hbm_zone.slot.code = u.code;                         //jaja temp
                //u.hbm_zone.slot.allMedia = codesForSend;               //jaja
                //u.hbm_zone.slot.inMediaQuery = checkMediaQuery;        //jaja  
		return u.hbm_zone.slot;
	});

	googletag.cmd.push(function() {
		pbjs.que.push(function() {
			pbjs.setTargetingForGPTAsync(codesForSend);
			if (YBCI && window.Yieldbird) {
				window.Yieldbird.cmd.push(function() {
					window.Yieldbird.refresh(slots);
				});
			}
			else {
				googletag.pubads().refresh(slots);
			}
		});
	});
}

function startAuction(units) {
	var unitsForSend = units.filter(function(u) {
		u.hbm_zone.refresh_counter = u.hbm_zone.refresh_counter || 0;
		if (u.hbm_zone.isRefresh && u.hbm_zone.refresh_limit > 0 && u.hbm_zone.refresh_counter >= u.hbm_zone.refresh_limit) 
			return false;
		if (u.hbm_zone.isRefresh) u.hbm_zone.refresh_counter ++;

		u.hbm_zone.unitForSend = true;
		u.hbm_zone.back = 0;
		return true;
	});
	if (unitsForSend.length == 0) return;

	var codesForSend = unitsForSend.map(function(u) {
		return u.code;
	});

	console.log("start auction "+codesForSend.join());

	if (APS) {
		var apsSlots = [];
		unitsForSend.forEach(function(u) {
			apsSlots.push({
				slotID: u.code,
				slotName: u.hbm_zone.slot_code,
				sizes: u.hbm_zone.slot_sizes,
			});
		});

		apstag.fetchBids({
			timeout: PREBID_TIMEOUT,
			slots: apsSlots,
		}, function(bids) {
			googletag.cmd.push(function() {
				apstag.setDisplayBids();
				unitsForSend.forEach(function(u) {
					u.hbm_zone.back += 1;
				});
				sendAdserverRequests(codesForSend);
			});
		});
	}

	pbjs.que.push(function() {
		pbjs.requestBids({
			timeout: PREBID_TIMEOUT,
			adUnitCodes: codesForSend,
			bidsBackHandler: function(){
                        console.log('unitsForSend^^');
                        console.log(codesForSend);
				unitsForSend.forEach(function(u) {
					u.hbm_zone.back += 1;
				});
//                                console.log('codesForSend^^');
//                                console.log(codesForSend);                            
				sendAdserverRequests(codesForSend);
			}
		});
	});

	setTimeout(function() {
		unitsForSend.forEach(function(u) {
			u.hbm_zone.back += (1 + APS);
		});
		sendAdserverRequests(codesForSend);
	}, FAILSAFE_TIMEOUT);
}

function intersectionObserverLazyLoading(entries, observer) {
	entries.forEach(function(entry) {
		var u = adUnits.filter(function(u) {
			return 'hbm-'+u.code === entry.target.id;
		})[0];
		if (u) {
			if (!u.hbm_zone.isLoaded && entry.intersectionRatio > 0) {
				u.hbm_zone.isLoaded = true;
				startAuction([u]);
				observer.unobserve(entry.target);
			}
		}
	});
};

function intersectionObserverRefresh(entries, observer) {
	entries.forEach(function(entry) {
		var u = adUnits.filter(function(u) {
			return 'hbm-'+u.code === entry.target.id;
		})[0];
		if (u) {
			u.hbm_zone.isVisible = entry.intersectionRatio > 0;
		}
	});
};

if (window.hbm_polyfill){
	window.hbm_polyfill.onload = function(){ onLoad(); }
}else{
	window.onload = function(){ onLoad(); }
}
function onLoad() {
	adUnits.filter(function(u) {
		return u.code && !u.hbm_zone.lazy_loading && u.hbm_zone.refresh;
	}).forEach(function(u) {
		setInterval(function() {
			u.hbm_zone.isRefresh = true;
			startAuction([u]);
		}, u.hbm_zone.refresh);
	});

	adUnits.filter(function(u) {
		return u.code && u.hbm_zone.lazy_loading;
	}).forEach(function(u) {
		var target = document.getElementById(u.code);
		if (target) {
			target.outerHTML = "<div id='hbm-"+u.code+"'>" + target.outerHTML + "</div>";
			var target2 = document.getElementById('hbm-'+u.code);
			var lazy_loading_offset = u.hbm_zone.lazy_loading_offset || 200;

			if (!('IntersectionObserver' in window)) {
				console.log("IntersectionObserver is undefined");
				return;
			}
			
			var observerLazyLoading = new IntersectionObserver(intersectionObserverLazyLoading, { root: null, rootMargin: "0px 0px "+lazy_loading_offset+"px 0px" });
			observerLazyLoading.observe(target2);
			if (u.hbm_zone.refresh) {
				var observerRefresh = new IntersectionObserver(intersectionObserverRefresh, { root: null, threshold: [0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0] });
				observerRefresh.observe(target2);
			}
		}
	});

	adUnits.filter(function(u) {
		return u.code && u.hbm_zone.lazy_loading && u.hbm_zone.refresh;
	}).forEach(function(u) {
		setInterval(function() {
			if (u.hbm_zone.isLoaded && u.hbm_zone.isVisible) {
				u.hbm_zone.isRefresh = true;
				startAuction([u]);
			}
		}, u.hbm_zone.refresh);
	});
}

var resizeTimerId;
if (REFRESH_ONRESIZE) {
	window.addEventListener("resize", function() {
		clearTimeout(resizeTimerId);
		resizeTimerId = setTimeout(doneResizing, 1000);
	});
}

function doneResizing(){
	console.log("resized");

	adUnits.filter(function(u) {
		return u.code && !u.hbm_zone.lazy_loading;
	}).forEach(function(u) {
		u.hbm_zone.isRefresh = false;
		startAuction([u]);
	});

	adUnits.filter(function(u) {
		return u.code && u.hbm_zone.lazy_loading;
	}).forEach(function(u) {
		if (u.hbm_zone.isLoaded) {
			u.hbm_zone.isRefresh = false;
			startAuction([u]);
		}
	});
}

googletag.cmd.push(function() {
	adUnits.forEach(function(u) {
		var target = document.getElementById(u.code);
		if (target) {
			if (!target.innerHTML) {
				googletag.display(u.code);
			}
		}
	});
});

function HBManager() {}

HBManager.prototype.dynamic = function(divid, zoneid) {
	var u = adUnits.filter(function(u) {
		return u.hbm_zone.zoneid == zoneid;
	})[0];
	if (!u) return;

	var target = document.getElementById(divid);
	if (target && u.code !== divid) {
		googletag.cmd.push(function() {
			u.code = divid;
			if (u.hbm_zone.outofpage)
				u.hbm_zone.slot = googletag.defineOutOfPageSlot(u.hbm_zone.slot_code, u.code);
			else
				u.hbm_zone.slot = googletag.defineSlot(u.hbm_zone.slot_code, u.hbm_zone.slot_sizes, u.code);
			if (adMapping[u.hbm_zone.zoneid])
				u.hbm_zone.slot.defineSizeMapping(adMapping[u.hbm_zone.zoneid]);
			u.hbm_zone.slot.addService(googletag.pubads());
			googletag.display(u.code);
			u.hbm_zone.isRefresh = false;
			startAuction([u]);
		});
	}
};

HBManager.prototype.refresh = function(zoneid){
	var u = adUnits.filter(function(u) {
		return u.hbm_zone.zoneid == zoneid;
	})[0];
	if (!u) return;
	u.hbm_zone.isRefresh = false;
	startAuction([u]);
};

window.HBManager = HBManager; 

}(window, document, pbjs, googletag));

var hbManager = new HBManager();




