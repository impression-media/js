!function(){"use strict";var AbstractEvent=function(){function t(t){this.name=t}return t.prototype.eval=function(t){},t}(),LogLevel,d;d=LogLevel||(LogLevel={}),d[d.Error=0]="Error",d[d.Warning=1]="Warning",d[d.Debug=2]="Debug";var CSS_LOG=["color: #fff;","background: #ff8f1c;","display: inline-block;","padding: 1px 4px;","border-radius: 3px;"].join(" "),Log=function(){function t(){}return t.Log=function(e,n){if(!(t.LOGLEVEL<e)){var o=LogLevel[e].toUpperCase(),i=window.navigator.userAgent,r=0<i.indexOf("MSIE ")||0<i.indexOf("Trident/");window.console?r?console.log("[PubTag] "+o+": "+n):console.log("%cPubTag",CSS_LOG,o+": "+n):e<=LogLevel.Error&&alert("[PubTag] "+o+": "+n)}},t.Debug=function(e){t.Log(LogLevel.Debug,e)},t.Warning=function(e){t.Log(LogLevel.Warning,e)},t.Error=function(e){t.Log(LogLevel.Error,e)},t.LOGLEVEL=LogLevel.Error,t}();function SetLogLevel(t){Log.LOGLEVEL=t}var TimeMeasurer=function(){function t(t){void 0===t&&(t=!0),t&&window.performance&&window.performance.now?this.now=window.performance.now.bind(window.performance):Date.now?this.now=Date.now:this.now=function(){return(new Date).getTime()}}return t.CreateRunning=function(){var e=new t;return e.start(),e},t.CreateWithStartTime=function(e){var n=new t(!1);return n.startTime=e,n},t.TimeSincePageLoad=function(){if(window.performance){if(window.performance.now)return window.performance.now();if(window.performance.timing&&window.performance.timing.navigationStart)return(new Date).getTime()-performance.timing.navigationStart}return 0},t.prototype.start=function(){this.startTime=this.now()},t.prototype.elapsed=function(){return this.now()-this.startTime},t}();function tryParseJson(t){try{return JSON.parse(t)}catch(t){return}}var CRITEO_VENDOR_ID=91,cmpCallbacks={};function hasCMP(t){return cmpInFrame(t)||void 0!==getCMPFrame(t)}function retrieveGDPRConsent(t,e,n){void 0===n&&(n=1e4);var o=TimeMeasurer.CreateRunning(),i=!1,r=setTimeout(function(){i=!0,Log.Warning("Timeout: Unable to resolve GDPR consent after "+n+"ms"),e(void 0)},n);executeCommand(t,"getVendorConsents",[CRITEO_VENDOR_ID],function(t,n){i||(clearTimeout(r),n?(Log.Debug("Consent retrieved in "+o.elapsed()+"ms"),getVendorConsentsCallback(t,e)):(Log.Warning("Error retrieving GDPR consent data from CMP"),e(void 0)))})}function getVendorConsentsCallback(t,e){if(t){var n={};void 0!==t.metadata&&(n.consentData=t.metadata),void 0!==t.gdprApplies&&(n.gdprApplies=!!t.gdprApplies),t.vendorConsents&&void 0!==t.vendorConsents[CRITEO_VENDOR_ID.toString()]&&(n.consentGiven=!!t.vendorConsents[CRITEO_VENDOR_ID.toString()]),e(n)}else Log.Warning("Unable to read GDPR consent data from CMP"),e(void 0)}function executeCommand(t,e,n,o){if(!cmpInFrame(t)){Log.Debug("No CMP defined on current frame");var i=getCMPFrame(t);t.__cmp=function(t,e,n){if(!i)return Log.Warning("CMP not found"),void n({msg:"CMP not found"},!1);var o=Math.random().toString(10),r={__cmpCall:{command:t,parameter:e,callId:o}};cmpCallbacks[o]=n,i.postMessage(r,"*")},t.addEventListener("message",function(t){var e="string"==typeof t.data?tryParseJson(t.data):t.data;if(e&&e.__cmpReturn&&e.__cmpReturn.callId&&e.__cmpReturn.returnValue){var n=e.__cmpReturn;cmpCallbacks[n.callId](n.returnValue,n.success),delete cmpCallbacks[n.callId]}},!1)}t.__cmp(e,n,o)}function cmpInFrame(t){return"function"==typeof t.__cmp}function getCMPFrame(t){for(var e,n=t,o=0;o<10;++o){try{n.frames.__cmpLocator&&(e=n)}catch(t){}if(n===t.top)break;n=n.parent}return e}function tryGetLocalStorage(t){try{return t.localStorage}catch(t){return}}var LocalStorageHelper=function(){function t(t){this.EXPIRE_SUFFIX="_expires",this.CHECK_STORAGE_KEY="criteo_localstorage_check",this.localStorage=tryGetLocalStorage(t||window)}return t.prototype.checkLocalStorage=function(){if(!this.localStorage)return!1;var t=this.CHECK_STORAGE_KEY;try{return this.localStorage.setItem(t,t),this.localStorage.removeItem(t),!0}catch(t){return!1}},t.prototype.removeItem=function(t){this.localStorage.removeItem(t),this.localStorage.removeItem(t+this.EXPIRE_SUFFIX)},t.prototype.getItem=function(t,e){var n=(new Date).getTime(),o=this.localStorage.getItem(t+this.EXPIRE_SUFFIX),i=o?parseInt(o,10):-1;return-1!==i&&i<n||e&&(-1===i||e<i-n)?(this.removeItem(t),null):this.localStorage.getItem(t)},t.prototype.setItem=function(t,e,n){if(this.localStorage.setItem(t,e),n){var o=(new Date).getTime()+n;this.localStorage.setItem(t+this.EXPIRE_SUFFIX,o.toString())}},t}(),DirectBiddingSilentModeManager=function(){function t(){this.localStorageHelper=new LocalStorageHelper,this.localStorageEnabled=this.localStorageHelper.checkLocalStorage()}return t.prototype.silentModeEnabled=function(){var e=t.SILENT_MODE_KEY;return this.localStorageEnabled&&null!==this.localStorageHelper.getItem(e)},t.prototype.enableSilentMode=function(e){if(this.localStorageEnabled){var n=t.SILENT_MODE_KEY;this.localStorageHelper.setItem(n,"1",e)}},t.SILENT_MODE_KEY="criteo_silent_mode",t}();function now(){return(new Date).getTime()}var Lock=function(){function t(t){this.x=t+"_lock_A",this.y=t+"_lock_B",this.id=Math.floor(1e9*Math.random()).toString()}return t.prototype.get=function(t){var e=localStorage.getItem(t);if(e){var n=e.split("|");if(!(n.length<2||parseInt(n[1],10)<now()))return n[0]}},t.prototype.set=function(t,e){var n=now()+e;localStorage.setItem(t,this.id+"|"+n)},t.prototype.acquire=function(t,e,n){var o=this;void 0===n&&(n=100),n<=0||this.tryAcquire(e)?(t(),this.release()):setTimeout(function(){o.acquire(t,e,n-10)},10)},t.prototype.tryAcquire=function(t){localStorage.setItem(this.x,this.id);var e=this.get(this.y);return!(e&&e!==this.id||(this.set(this.y,t),localStorage.getItem(this.x)!==this.id||this.get(this.y)!==this.id))},t.prototype.release=function(){localStorage.removeItem(this.x),localStorage.removeItem(this.y)},t}(),Size=function(){function t(t,e){this.width=t,this.height=e}return t.prototype.toString=function(){return this.width+"x"+this.height},t}(),SlotKey=function(){function t(t){this.impressionId=t}return t.prototype.toString=function(){return"ImpId"+this.impressionId},t}(),__extends=(Qa=function(t,e){return(Qa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}Qa(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Qa,SlotKeyWithSize=function(t){function e(e,n,o){var i=t.call(this,e)||this;return i.size=n,i.networkId=o,i}return __extends(e,t),e.prototype.toString=function(){return t.prototype.toString.call(this)+"_Size"+this.size+"_NetworkId"+this.networkId},e}(SlotKey),__extends$1=(fb=function(t,e){return(fb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}fb(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),fb,SlotKeyWithZoneId=function(t){function e(e,n){var o=t.call(this,e)||this;return o.zoneId=n,o}return __extends$1(e,t),e.prototype.toString=function(){return t.prototype.toString.call(this)+"_ZoneId"+this.zoneId},e}(SlotKey),SlotKeyFactory=function(){function t(t,e){this.useZoneIdIntegration=t,this.networkId=e}return t.prototype.createKeysFromSlotRequest=function(t){if(this.useZoneIdIntegration)return[new SlotKeyWithZoneId(t.impId,t.zoneId)];for(var e=[],n=0,o=t.sizes;n<o.length;n++){var i=o[n];e.push(new SlotKeyWithSize(t.impId,i,this.networkId))}return e},t.prototype.createKeyFromSlotResponse=function(t){return this.useZoneIdIntegration?new SlotKeyWithZoneId(t.impid,t.zoneid):new SlotKeyWithSize(t.impid,new Size(t.width,t.height),this.networkId)},t.prototype.createKeyFromBid=function(t){return this.useZoneIdIntegration?new SlotKeyWithZoneId(t.impressionId,t.zoneId):new SlotKeyWithSize(t.impressionId,new Size(t.width,t.height),this.networkId)},t}(),DirectBiddingBidManager=function(){function t(t,e){this.localStorageHelper=new LocalStorageHelper,this.localStorageEnabled=this.localStorageHelper.checkLocalStorage(),this.slotKeyFactory=new SlotKeyFactory(t,e)}return t.useZoneIdIntegration=function(t,e){return void 0===e||0===t.filter(function(t){return void 0!==t.sizes&&0<t.sizes.length}).length},t.prototype.get=function(e){var n=t.BID_KEY_PREFIX+e.toString(),o=this.localStorageHelper.getItem(n),i=o&&tryParseJson(o);return i&&"object"==typeof i&&"bids"in i?(i.bids=i.bids.filter(function(t){return t.expiration>now()}),i):{bids:[]}},t.prototype.set=function(e,n){var o=t.BID_KEY_PREFIX+e.toString();0<n.bids.length||n.no_bid&&n.no_bid>now()?this.localStorageHelper.setItem(o,JSON.stringify(n)):this.localStorageHelper.removeItem(o)},t.prototype.filterNoBidSlots=function(e){for(var n=[],o=0,i=e;o<i.length;o++){for(var r=i[o],a=[],s=0,d=this.slotKeyFactory.createKeysFromSlotRequest(r);s<d.length;s++){var c=d[s];this.getBid(c,0)!==t.NO_BID&&(c instanceof SlotKeyWithSize?a.push(c.size):n.push(r))}0<a.length&&(r.sizes=a,n.push(r))}return n},t.prototype.getRequestCachedBids=function(e,n){void 0===n&&(n=5e3);for(var o=[],i=0,r=e;i<r.length;i++)for(var a=r[i],s=0,d=this.slotKeyFactory.createKeysFromSlotRequest(a);s<d.length;s++){var c=d[s],l=this.getBid(c,n);void 0!==l&&l!==t.NO_BID&&o.push(l)}return o},t.prototype.getBid=function(e,n){if(void 0===n&&(n=5e3),this.localStorageEnabled){var o=this.get(e);if(o.no_bid&&o.no_bid>now())return t.NO_BID;if(0<n)for(var i=0,r=o.bids;i<r.length;i++){var a=r[i];if(new Lock(t.BID_KEY_PREFIX+a.bid.slotid).tryAcquire(n))return a.bid}}},t.prototype.storeRequestNoBid=function(t,e){for(var n=0,o=this.slotKeyFactory.createKeysFromSlotRequest(t);n<o.length;n++){var i=o[n];this.storeNoBid(i,e)}},t.prototype.storeResponseBid=function(t,e){var n=this.slotKeyFactory.createKeyFromSlotResponse(t);this.modifyCache(n,function(n){n.bids.push({bid:t,expiration:now()+1e3*e})})},t.prototype.storeNoBid=function(t,e){this.modifyCache(t,function(t){t.no_bid=Math.max(t.no_bid||0,now()+1e3*e)})},t.prototype.removeBid=function(t){var e=this.slotKeyFactory.createKeyFromBid(t);this.modifyCache(e,function(e){for(var n=0;n<e.bids.length;n++)if(e.bids[n].bid.slotid===t.slotId)return void e.bids.splice(n,1)}),new Lock(e.toString()).release()},t.prototype.modifyCache=function(t,e){var n=this;if(this.localStorageEnabled){var o=new Lock(t.toString());o.acquire(function(){var i=n.get(t);e(i),n.set(t,i),o.release()},1e3)}},t.NO_BID="nobid",t.BID_KEY_PREFIX="criteo_pt_cdb_bidcache_",t}(),DirectBiddingCache=function(){function t(t,e,n){var o=DirectBiddingBidManager.useZoneIdIntegration(e,n);this.bidManager=new DirectBiddingBidManager(o,n),this.silentModeManager=new DirectBiddingSilentModeManager,this.context=t}return t.prototype.filterNoBidSlots=function(t){var e=this.bidManager.filterNoBidSlots(t);return this.context.shouldIgnoreSilentMode?(e.length!==t.length&&this.context.setSilentModeIgnored&&this.context.setSilentModeIgnored(),t):e},t.prototype.silentModeEnabled=function(){var t=!1;return this.silentModeManager.silentModeEnabled()&&(this.context.shouldIgnoreSilentMode&&this.context.setSilentModeIgnored?this.context.setSilentModeIgnored():t=!0),t},t.prototype.getCachedBids=function(t){return this.bidManager.getRequestCachedBids(t)},t.prototype.removeBid=function(t){this.bidManager.removeBid(t)},t.prototype.handleResponse=function(t,e,n,o){var i=n.time_to_next_call;0<i&&(Log.Debug("Global silent mode enabled for "+i+" seconds"),this.silentModeManager.enableSilentMode(1e3*i));var r={};if(n.slots)for(var a=0,s=n.slots;a<s.length;a++)(h=s[a]).ttl&&(r[h.imp_id]=h.ttl);if(e.slots)for(var d=0,c=e.slots;d<c.length;d++){var l=0;(h=c[d]).slotid in r&&(l=r[h.slotid],delete r[h.slotid]),o&&0<l&&(Log.Debug("Post-timeout bid for slot '"+h.impid+"' cached for "+l+" seconds"),this.bidManager.storeResponseBid(h,l))}for(var u in r)if(r.hasOwnProperty(u))for(var p=0,f=t;p<f.length;p++){var h;(h=f[p]).slotId===u&&(l=r[u],Log.Debug("Silent mode for slot '"+h.impId+"' enabled for "+l+" seconds"),this.bidManager.storeRequestNoBid(h,l))}},t}(),AsyncRequest=function(){function t(t,e,n,o){void 0===o&&(o=!0),this.url=t,this.data=e,this.contentType=n,this.withCredentials=o}return t.prototype.send=function(t,e,n,o){var i=void 0!==this.data?"POST":"GET",r=this.getXMLHttpRequest(i,t,e,n,o);if(void 0!==r)r.send(this.data);else{var a=this.getXDomainRequest(i,t,e,n,o);void 0!==a&&a.send(this.data)}},t.prototype.getXMLHttpRequest=function(e,n,o,i,r){var a=new XMLHttpRequest;if("withCredentials"in a)return a.open(e,this.url,!0),a.timeout=r||t.LOCAL_PASSBACK_TIMEOUT,this.contentType?a.setRequestHeader("Content-type",this.contentType):"POST"===e&&a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.withCredentials=this.withCredentials,a.onload=function(){4===a.readyState&&200===a.status?n(a.responseText):o(a.readyState,a.status)},a.onerror=function(){o(void 0,void 0)},i&&(a.ontimeout=i),a},t.prototype.getXDomainRequest=function(e,n,o,i,r){if("undefined"!=typeof XDomainRequest){var a=new XDomainRequest;return a.timeout=r||t.LOCAL_PASSBACK_TIMEOUT,a.open(e,this.url),a.onload=function(){void 0!==a.responseText?n(a.responseText):o(void 0,void 0)},a.onerror&&(a.onerror=function(){o(void 0,void 0)}),a.ontimeout&&i&&(a.ontimeout=i),a}},t.LOCAL_PASSBACK_TIMEOUT=3e4,t}();function resolvePrebidTimeout(t){var e="number"==typeof window.PREBID_TIMEOUT?window.PREBID_TIMEOUT:void 0;return t&&e?Math.min(t,e):t||e||void 0}var PublisherTagVersion=65,DirectBiddingMetric=function(t,e,n,o,i,r,a,s,d,c,l,u){this.publisherTagVersion=t,this.slots=e,this.elapsed=n,this.isTimeout=o,this.pageLoadElapsed=i,this.adapterStartElapsed=r,this.cdbCallStartElapsed=a,this.cdbCallEndElapsed=s,this.adapterEndElapsed=d,this.setTargetingElapsed=c,this.adapterTimeout=l,this.adapterIsTimeout=u},DirectBiddingMetricSlot=function(t,e,n,o){this.impressionId=t,this.zoneId=e,this.adUnitId=n,this.cachedBidUsed=o},DirectBiddingMetricBuilder=function(){function t(){this.elapsed=0,this.isTimeout=!1,this.pageLoadElapsed=0,this.adapterStartElapsed=0,this.cdbCallStartElapsed=0,this.cdbCallEndElapsed=0,this.adapterEndElapsed=0,this.cachedBidsReturned=[],this.slots=[]}return t.prototype.withElapsed=function(t){return this.elapsed=Math.round(t),this},t.prototype.withIsTimeout=function(t){return this.isTimeout=t,this},t.prototype.withPageLoadElapsed=function(t){return this.pageLoadElapsed=Math.round(t),this},t.prototype.withAdapterStartElapsed=function(t){return this.adapterStartElapsed=Math.round(t),this},t.prototype.withCdbCallStartElapsed=function(t){return this.cdbCallStartElapsed=Math.round(t),this},t.prototype.withCdbCallEndElapsed=function(t){return this.cdbCallEndElapsed=Math.round(t),this},t.prototype.withSetTargetingElapsed=function(t){return this.setTargetingElapsed=Math.round(t),this},t.prototype.withAdapterEndElapsed=function(t){return this.adapterEndElapsed=Math.round(t),this},t.prototype.withAdapterTimeout=function(t){return this.adapterTimeout=t&&Math.round(t),this},t.prototype.withCachedBidsReturned=function(t){return this.cachedBidsReturned=t,this},t.prototype.addSlot=function(t,e,n){var o=0<this.cachedBidsReturned.filter(function(t){return t.impid===n&&t.zoneid===e}).length;return this.slots.push(new DirectBiddingMetricSlot(t,e,n,o)),this},t.prototype.build=function(){var t;return void 0!==this.adapterTimeout&&(t=this.adapterEndElapsed>this.adapterTimeout),new DirectBiddingMetric(PublisherTagVersion,this.slots,this.elapsed,this.isTimeout,this.pageLoadElapsed,this.adapterStartElapsed,this.cdbCallStartElapsed,this.cdbCallEndElapsed,this.adapterEndElapsed,this.setTargetingElapsed,this.adapterTimeout,t)},t}(),DirectBiddingMetricsManager=function(){function t(){this.localStorageHelper=new LocalStorageHelper,this.localStorageEnabled=this.localStorageHelper.checkLocalStorage()}return t.prototype.getMetrics=function(e){if(this.localStorageEnabled){var n=t.METRICS_STORAGE_KEY,o=this.localStorageHelper.getItem(n),i=o?tryParseJson(o):[];return e&&this.localStorageHelper.removeItem(n),i}return[]},t.prototype.setMetrics=function(e){if(this.localStorageEnabled){var n=t.METRICS_STORAGE_KEY;this.localStorageHelper.setItem(n,JSON.stringify(e),36e5)}},t.prototype.storeMetric=function(t){if(this.localStorageEnabled){var e=this.getMetrics(!1);e.push(t),this.setMetrics(e)}},t.METRICS_STORAGE_KEY="criteo_pt_cdb_metrics",t}(),IntegrationMode,Ce;function parse(t){switch(t.toLowerCase()){case"amp":return IntegrationMode.AMP;default:return IntegrationMode.Unspecified}}Ce=IntegrationMode||(IntegrationMode={}),Ce[Ce.Unspecified=0]="Unspecified",Ce[Ce.AMP=1]="AMP";var DirectBiddingRequestBuilder=function(){function t(t,e,n,o,i,r,a,s,d,c){this.slots=t,this.context=e,this.metricsManager=n,this.urlBuilder=o,this.profileId=i,this.integrationMode=r||IntegrationMode.Unspecified,this.networkId=a,this.adapterVersion=s,this.gdprConsent=d,this.wrapperVersion=c}return t.prototype.isValid=function(){return 0<this.slots.length},t.prototype.getRequest=function(){for(var t=[],e=0,n=this.slots;e<n.length;e++){var o=n[e],i={slotid:o.slotId,impid:o.impId};if(void 0!==o.zoneId&&(i.zoneid=o.zoneId),void 0!==o.nativeCallback&&(i.native=!0),void 0!==o.transactionId&&(i.transactionid=o.transactionId),void 0!==o.publisherSubId&&(i.publishersubid=o.publisherSubId),void 0!==o.sizes){for(var r=[],a=0,s=o.sizes;a<s.length;a++){var d=s[a];r.push(d.width+"x"+d.height)}i.sizes=r}t.push(i)}var c={publisher:{url:this.context.highestAccessibleUrl},slots:t};void 0!==this.networkId&&(c.publisher.networkid=this.networkId);var l=this.metricsManager.getMetrics(!0);return l.length&&(c.previousBidFeedback=l),this.gdprConsent&&(c.gdprConsent=this.gdprConsent),c},t.prototype.getUrl=function(){return this.urlBuilder.buildUrl(this.profileId,this.context,this.integrationMode,this.adapterVersion,this.wrapperVersion)},t}();function extractExtraData(t){var e={slots:void 0,time_to_next_call:0};return void 0!==t.exd&&(void 0!==t.exd.time_to_next_call&&(e.time_to_next_call=t.exd.time_to_next_call),e.slots=t.exd.slots,delete t.exd),e}function getPreciseRequestDuration(t){if(window.performance&&window.performance.getEntries)for(var e=window.performance.getEntries(),n=e.length-1;0<=n;--n){var o=e[n];if(o.name===t&&o.duration)return Math.round(o.duration)}}var DirectBiddingTimer=function(){function t(t,e,n){this.hasSetTargetingBeenCalled=!1,this.builder=t,this.timer=void 0!==e?TimeMeasurer.CreateWithStartTime(e):TimeMeasurer.CreateRunning();var o=this.timer.elapsed();this.builder.withAdapterStartElapsed(o),this.builder.withPageLoadElapsed(TimeMeasurer.TimeSincePageLoad()-o),void 0!==n&&this.builder.withAdapterTimeout(n)}return t.prototype.sendRequest=function(t){this.url=t,this.sendTime=TimeMeasurer.CreateRunning(),this.builder.withCdbCallStartElapsed(this.timer.elapsed())},t.prototype.requestReceived=function(t){void 0===t&&(t=!1),this.builder.withElapsed(getPreciseRequestDuration(this.url)||this.sendTime.elapsed()),this.builder.withCdbCallEndElapsed(this.timer.elapsed()),this.builder.withIsTimeout(t)},t.prototype.setTargeting=function(){this.hasSetTargetingBeenCalled||(this.builder.withSetTargetingElapsed(this.timer.elapsed()),this.hasSetTargetingBeenCalled=!0)},t.prototype.finish=function(t){if(this.builder.withAdapterEndElapsed(this.timer.elapsed()),t&&0!==t.length)for(var e=0,n=t;e<n.length;e++){var o=n[e];this.builder.addSlot(o.imp_id,o.zone_id,o.ad_unit_id)}else this.builder.addSlot("");return this.build()},t.prototype.build=function(){return this.builder.build()},t}(),__extends$2=(qf=function(t,e){return(qf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}qf(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),qf,DirectBiddingEvent=function(t){function e(n,o,i,r,a,s,d,c,l,u){var p=t.call(this,e.NAME)||this;return p.profileId=n,p.urlBuilder=o,p.slots=i,p.metricBuilder=new DirectBiddingMetricBuilder,p.metricsManager=new DirectBiddingMetricsManager,p.callbackSuccess=r,p.callbackError=a,p.callbackTimeout=s,p.timeout=d,p.networkId=c,p.integrationMode=l,p.adapterVersion=u,p}return __extends$2(e,t),e.prototype.setGDPRConsent=function(t){this.gdprConsent=t},e.prototype.getMetricBuilder=function(){return this.metricBuilder},e.prototype.eval=function(t){this.evalWithTimeout(t,void 0)},e.prototype.evalWithTimeout=function(t,n){var o=this,i=e.getCriteoAdapterBidRequest(),r=e.getRequestAuctionStart(i),a=n||resolvePrebidTimeout(i&&i.timeout),s=new DirectBiddingTimer(this.metricBuilder,r,a),d=new DirectBiddingRequestBuilder(this.slots,t.context,this.metricsManager,this.urlBuilder,this.profileId,this.integrationMode,this.networkId,this.adapterVersion,this.gdprConsent);if(d.isValid()&&"undefined"!=typeof JSON){var c=d.getRequest(),l=JSON.stringify(c),u=d.getUrl(),p=new AsyncRequest(u,l,"application/x-www-form-urlencoded");s.sendRequest(u),p.send(function(t){s.requestReceived();var e=tryParseJson(t)||{},n=extractExtraData(e);void 0!==o.callbackSuccess&&o.callbackSuccess(JSON.stringify(e),n),o.metricsManager.storeMetric(s.finish(n.slots))},function(t,e){s.requestReceived(),void 0!==o.callbackError&&o.callbackError(t,e),o.metricsManager.storeMetric(s.finish())},function(){s.requestReceived(!0),void 0!==o.callbackTimeout&&o.callbackTimeout(),o.metricsManager.storeMetric(s.finish())},this.timeout)}else this.callbackError(void 0,void 0)},e.getCriteoAdapterBidRequest=function(){try{return window.pbjs._bidsRequested.find(function(t){return"criteo"===t.bidderCode})}catch(t){return}},e.getRequestAuctionStart=function(t){return t&&t.auctionStart},e.NAME="directbidding",e}(AbstractEvent),__extends$3=(ig=function(t,e){return(ig=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}ig(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),ig,DirectBiddingEventWithCaching=function(t){function e(n,o,i,r,a,s,d,c,l,u){var p=t.call(this,e.NAME)||this,f=Math.max(10*(d||3e3),3e3);return p.cache=new DirectBiddingCache(window.criteo_pubtag.context,i,c),p.directBiddingEvent=new DirectBiddingEvent(n,o,p.cache.filterNoBidSlots(i),function(t,e){return p.onSuccess(t,e)},function(t,e){return p.onError(t,e)},function(){return p.onHttpTimeout()},f,c,l,u),p.slots=i,p.callbackSuccess=r,p.callbackError=a,p.callbackTimeout=s,p.timeout=d,p.hasTimeouted=!1,p.hasResponded=!1,p}return __extends$3(e,t),e.prototype.eval=function(t){var e=this;hasCMP(window)?retrieveGDPRConsent(window,function(n){e.evalWithCmp(t,n)}):this.evalWithCmp(t,void 0)},e.prototype.evalWithCmp=function(t,e){var n=this;if(this.cache.silentModeEnabled())return Log.Debug("Request ignored because the global silent mode is enabled"),void this.callbackSuccess("",void 0);setTimeout(function(){return n.onTimeout()},this.timeout||3e3),this.directBiddingEvent.setGDPRConsent(e),this.directBiddingEvent.evalWithTimeout(t,this.timeout)},e.prototype.onSuccess=function(t,e){if(this.hasResponded=!0,void 0!==e){var n=tryParseJson(t);this.cache.handleResponse(this.slots,n,e,this.hasTimeouted)}this.hasTimeouted||this.callbackSuccess(t,e)},e.prototype.onError=function(t,e){this.hasResponded=!0,this.hasTimeouted||this.callbackError(t,e)},e.prototype.onHttpTimeout=function(){this.hasResponded=!0,this.hasTimeouted||this.callbackTimeout()},e.prototype.onTimeout=function(){if(!this.hasResponded){this.hasTimeouted=!0;var t=this.cache.getCachedBids(this.slots);0===t.length?this.callbackTimeout():(Log.Debug("Cached bids returned because of timeout: ['"+t.map(function(t){return t.impid}).join("', '")+"']"),this.directBiddingEvent.getMetricBuilder().withCachedBidsReturned(t),this.callbackSuccess(JSON.stringify({slots:t}),void 0))}},e.prototype.getMetricBuilder=function(){return this.directBiddingEvent.getMetricBuilder()},e.prototype.getBidCache=function(){return this.cache},e.NAME="directbidding",e}(AbstractEvent),CacheBusterGenerator=function(){function t(){}return t.generateCacheBuster=function(){return Math.floor(99999999999*Math.random())},t}(),DirectBiddingUrlBuilder=function(){function t(t){void 0===t&&(t=!1),this.auditMode=t}return t.prototype.buildUrl=function(e,n,o,i,r){void 0===o&&(o=IntegrationMode.Unspecified);var a=("https:"===n.protocol?"https:":"http:")+t.CRITEO_BIDDER_URL+this.getHandlerPath();return a+="?ptv="+PublisherTagVersion,a+="&profileId="+String(e),a+=n.ctoIdOnPublisherDomain?"&idcpy="+n.ctoIdOnPublisherDomain:"",a+=n.idfs?"&idfs="+n.idfs:"",a+=n.secureId?"&sid="+n.secureId:"",a+=n.isOptOut?"&optout=1":"",o!==IntegrationMode.Unspecified&&(a+="&im="+o),void 0!==i&&(a+="&av="+String(i)),void 0!==r&&(a+="&wv="+encodeURIComponent(r)),a+=n.silentModeIgnored?"&smi=1":"",(a+="&cb="+String(CacheBusterGenerator.generateCacheBuster()))+n.getContextFlags()},t.prototype.getHandlerPath=function(){return this.auditMode?t.CRITEO_BIDDER_AUDIT_HANDLER:t.CRITEO_BIDDER_HANDLER},t.CRITEO_BIDDER_URL="//bidder.criteo.com/",t.CRITEO_BIDDER_HANDLER="cdb",t.CRITEO_BIDDER_AUDIT_HANDLER="prebid/audit",t}();function retrieveGoogleTagPlacements(t){window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],window.googletag.cmd.push(function(){var e=googleSlotsToDynamicSlots(window.googletag.pubads().getSlots());t(e)})}function googleSlotsToDynamicSlots(t){for(var e=[],n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,o=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,i=0,r=t;i<r.length;i++){for(var a=r[i],s=a.getSlotElementId(),d=[],c=0,l=a.getSizes(n,o)||a.getSizes();c<l.length;c++){var u=l[c];"function"==typeof u.getWidth&&u.getWidth()&&"function"==typeof u.getHeight&&u.getHeight()&&d.push(u.getWidth()+"x"+u.getHeight())}s&&0<d.length&&e.push({slotId:s,sizes:d})}return e}function createEmptyDFPTargeting(){return createDFPTargeting(null,null)}function createDFPTargeting(t,e){return{crt_pb:[t],crt_bidid:[e]}}var DFPKeyValueTargeter=function(){function t(){void 0===window.googletag&&(window.googletag={}),this.googletag=window.googletag,this.googletag.cmd=this.googletag.cmd||[]}return t.prototype.setKeyValuesForAllSlots=function(t){var e=this;this.googletag.cmd.push(function(){for(var n in t)t.hasOwnProperty(n)&&(e.googletag.pubads().clearTargeting(n),e.googletag.pubads().setTargeting(n,t[n]+""))})},t.prototype.setKeyValuePerSlot=function(t,e){var n=this.googletag.pubads().getSlots().filter(function(e){return e.getSlotElementId()===t});0===n.length?Log.Warning("No googletag slot found for slotId: "+t):1<n.length?Log.Warning("More than one googletag slot found for slotId: "+t):this.googletag.cmd.push(function(){for(var t in e)e.hasOwnProperty(t)&&(n[0].clearTargeting(t),n[0].setTargeting(t,e[t]+""))})},t.prototype.resetKeyValuesForSlots=function(t){var e=this,n=createEmptyDFPTargeting();this.googletag.pubads().getSlots().filter(function(e){return-1!==t.indexOf(e.getSlotElementId())}).forEach(function(t){e.googletag.cmd.push(function(){for(var e in n)n.hasOwnProperty(e)&&t.clearTargeting(e)})})},t}();function executeFunction(val,args){if(val){var ret;try{ret=eval("("+val+")")}catch(t){return void Log.Error("Error evaluating the function: "+t)}if("function"==typeof ret)return ret.apply(ret,args);Log.Error("The passed value is not a function")}else Log.Error("Cannot execute an empty function")}function getParam(t,e,n){return typeof t[e]===n?t[e]:void 0}var BidEventTarget=function(){},__extends$4=(Sh=function(t,e){return(Sh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}Sh(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Sh,BidEventContainerTarget=function(_super){function BidEventContainerTarget(t,e){var n=_super.call(this)||this;n.containerId=e;var o=t.getElementById(e);return o?n.element=o:Log.Error("Target element '"+e+"' not found in the document"),n}return __extends$4(BidEventContainerTarget,_super),BidEventContainerTarget.prototype.ResizeFrame=function(t,e){},BidEventContainerTarget.prototype.Write=function(t){this.element&&(this.element.innerHTML=t)},BidEventContainerTarget.prototype.LoadScript=function(url){url+=-1===url.indexOf("?")?"?":"&",url+="containerid="+encodeURIComponent(this.containerId);var request=new AsyncRequest(url);request.send(function(responseText){eval(responseText)},function(){},function(){})},BidEventContainerTarget}(BidEventTarget),__extends$5=(ii=function(t,e){return(ii=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}ii(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),ii,BidEventDocumentTarget=function(t){function e(e){var n=t.call(this)||this;return n.document=e,n}return __extends$5(e,t),e.prototype.ResizeFrame=function(t,e){if(this.document.defaultView&&this.document.defaultView.frameElement){var n=this.document.defaultView.frameElement;n.width=t.toString(),n.height=e.toString()}},e.prototype.Write=function(t){this.document.open(),this.document.write(t),this.document.close()},e.prototype.LoadScript=function(t){this.Write("<script type='text/javascript' src='"+t+"'><\/script>")},e}(BidEventTarget),__extends$6=(Ci=function(t,e){return(Ci=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}Ci(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Ci,Custom=function(t){function e(n){var o=t.call(this,e.NAME)||this;return o.callback=n,o}return __extends$6(e,t),e.prototype.eval=function(t){this.callback&&this.callback.apply(this)},e.NAME="genericEvent",e}(AbstractEvent),BidResponseSlot=function(){function t(t,e,n,o,i,r){this.id=this.generateRandomId(),this.slotId=t,this.impressionId=e,this.cpm=n,this.width=o,this.height=i,this.zoneId=r}return t.prototype.generateRandomId=function(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,6)},t}(),__extends$7=(Zi=function(t,e){return(Zi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}Zi(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Zi,DisplayUrlBidResponseSlot=function(t){function e(e,n,o,i,r,a,s){var d=t.call(this,e,n,o,i,r,a)||this;return d.displayUrl=s,d}return __extends$7(e,t),e.prototype.GenerateEvent=function(t){var e=this;return t.ResizeFrame(this.width,this.height),new Custom(function(){return t.LoadScript(e.displayUrl)})},e.prototype.GenerateMessage=function(){return{displayUrl:this.displayUrl}},e}(BidResponseSlot),__extends$8=(uj=function(t,e){return(uj=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}uj(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),uj,HtmlCreativeBidResponseSlot=function(t){function e(e,n,o,i,r,a,s){var d=t.call(this,e,n,o,i,r,a)||this;return d.creative=s,d}return __extends$8(e,t),e.prototype.GenerateEvent=function(t){var e=this;return t.ResizeFrame(this.width,this.height),new Custom(function(){return t.Write(e.creative)})},e.prototype.GenerateMessage=function(){return{creative:this.creative}},e}(BidResponseSlot),LineItemRange=function(){function t(t,e,n){this.lowerBound=t,this.upperBound=e,this.increment=n}return t.createLineItemRangesFromString=function(e){for(var n=[],o=0,i=e.split(";");o<i.length;o++){var r=i[o],a=r.split(".."),s=t.roundToDecimal(a[0],2),d=a[1].split(":"),c=t.roundToDecimal(d[0],2),l=t.roundToDecimal(d[1],2);if(isNaN(s)||isNaN(c)||isNaN(l)||0===l){Log.Warning("Could not parse range parameter: "+r);break}if(s<0||c<0||l<0){Log.Warning("Positive values must be set for range bounds: "+r);break}var u=c-s,p=u/l,f=p===Math.floor(p);c<s?Log.Warning("Lower bound ("+s+") greater than upper bound ("+c+")"):f?n.push(new t(s,c,l)):Log.Warning("Range ("+u+") is not divisible by increment ("+l+")")}return n.sort(function(t,e){return t.upperBound>e.upperBound?1:e.upperBound>t.upperBound?-1:0}),n},t.getDefaultDenseLineItemRanges=function(){return[new t(0,3,.01),new t(3,8,.05),new t(8,20,.5)]},t.computeLineItemPricebandValue=function(e,n){0===n.length&&(n=t.getDefaultDenseLineItemRanges());for(var o=0,i=n;o<i.length;o++){var r=i[o];if(e<=r.upperBound&&e>r.lowerBound){var a=Math.floor(e/r.increment+1e-4)*r.increment;return t.formatPriceBand(a)}}return e<n[0].lowerBound?void 0:e===n[0].lowerBound?t.formatPriceBand(n[0].lowerBound):t.formatPriceBand(n[n.length-1].upperBound)},t.formatPriceBand=function(t){return t.toFixed(2)},t.roundToDecimal=function(t,e){var n=parseFloat(t),o=Math.pow(10,e);return Math.round(n*o)/o},t}(),__extends$9=(xk=function(t,e){return(xk=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}xk(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),xk,NativeBidResponseSlot=function(t){function e(e,n,o,i,r,a,s,d){var c=t.call(this,e,n,o,i,r,a)||this;return c.nativeCallback=s,c.nativePayload=d,c}return __extends$9(e,t),e.prototype.GenerateEvent=function(t){var e=this;return"function"!=typeof this.nativeCallback?(Log.Error("'nativeCallback' parameter is not a function in placements object"),new Custom(void 0)):"object"!=typeof this.nativePayload?(Log.Error("'nativePayload' parameter is not an object in placements object"),new Custom(void 0)):new Custom(function(){return e.nativeCallback(e.nativePayload)})},e.prototype.GenerateMessage=function(){return{nativePayload:this.nativePayload}},e}(BidResponseSlot),InputParameters=function(){function t(){var t=this;this.integrationMode=IntegrationMode.Unspecified,this.paramParser={},this.addParameter("integrationMode",function(e){t.integrationMode=parse(e)})}return t.prototype.addParameter=function(t,e){this.paramParser[t.toLowerCase()]=e},t.prototype.tryFillParameters=function(t){for(var e in t)if(void 0!==t[e]){var n=e.toLowerCase();this.paramParser[n]?this.paramParser[n](t[e]):Log.Warning("Unknown parameter: "+e)}},t}(),__extends$10=(bl=function(t,e){return(bl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}bl(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),bl,RenderAdInputParameters=function(t){function e(e){var n=t.call(this)||this;return n.bidId=void 0,n.document=window.document,n.containerId=void 0,n.addParameter("bidId",function(t){n.bidId=t}),n.addParameter("document",function(t){n.document=t}),n.addParameter("containerId",function(t){n.containerId=t}),t.prototype.tryFillParameters.call(n,e),n}return __extends$10(e,t),e}(InputParameters);function generateUuid(){var t=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(t+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?n:3&n|8).toString(16)})}var DirectBiddingSlot=function(t,e,n,o,i,r){this.slotId=generateUuid().replace(/-/g,""),this.impId=t,this.zoneId=e,this.nativeCallback=n,this.transactionId=o,this.sizes=i,this.publisherSubId=r},__extends$11=(Dl=function(t,e){return(Dl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}Dl(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Dl,PlacementInputParameters=function(t){function e(e){var n=t.call(this)||this;return n.slotId=void 0,n.zoneId=void 0,n.sizes=[],n.nativeCallback=void 0,n.publisherSubId=void 0,n.addParameter("slotid",function(t){n.slotId=t}),n.addParameter("zoneid",function(t){n.zoneId=t}),n.addParameter("sizes",function(t){for(var e=0,o=t;e<o.length;e++){var i=o[e].split("x");n.sizes.push(new Size(parseInt(i[0],10),parseInt(i[1],10)))}}),n.addParameter("nativecallback",function(t){n.nativeCallback=t}),n.addParameter("publisherSubId",function(t){n.publisherSubId=t}),t.prototype.tryFillParameters.call(n,e),n}return __extends$11(e,t),e}(InputParameters),__extends$12=(_l=function(t,e){return(_l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}_l(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),_l,StandaloneInputParameters=function(t){function e(e){var n=t.call(this)||this;return n.placements=void 0,n.networkId=void 0,n.addParameter("networkId",function(t){n.networkId=t}),n.addParameter("placements",function(t){n.placements=n.deserializePlacementInput(t)}),t.prototype.tryFillParameters.call(n,e),n}return __extends$12(e,t),e.prototype.deserializePlacementInput=function(t){for(var e=[],n=0,o=t;n<o.length;n++){var i=o[n],r=new PlacementInputParameters(i);e.push(new DirectBiddingSlot(r.slotId,r.zoneId,r.nativeCallback,void 0,r.sizes,r.publisherSubId))}return e},e}(InputParameters),standaloneProfileId=184;function RequestBids(t,e,n){RequestBidsWithProfileId(t,standaloneProfileId,e,n)}function DiscoverTagsAndRequestBids(t,e,n){retrieveGoogleTagPlacements(function(o){o.length<=0?Log.Warning("No Google tag placements have been retrieved, no bid will be requested."):RequestBidsWithProfileId({networkId:t,placements:o},standaloneProfileId,e,n)})}function RequestBidsOnGoogleTagSlots(t,e,n){if("number"==typeof t)DiscoverTagsAndRequestBids(o=t,e,n);else{var o=getParam(t,"networkId","number"),i=getParam(t,"placements","object"),r=getParam(t,"callback","function"),a=getParam(t,"timeout","function");void 0===i?DiscoverTagsAndRequestBids(o,r,a):RequestBidsWithProfileId({networkId:o,placements:googleSlotsToDynamicSlots(i)},standaloneProfileId,r,a)}}var metricBuilders={},bidCaches={};function RequestBidsWithProfileId(t,e,n,o){var i=new StandaloneInputParameters(t);if(checkInputParameters(i)){for(var r=function(){void 0!==n&&n([])},a=new DirectBiddingEventWithCaching(e,new DirectBiddingUrlBuilder(!1),i.placements,function(t){var e=tryParseJson(t);if(void 0!==e&&void 0!==e.slots){var o={};if(e.invocation_codes)for(var r=0,a=e.invocation_codes;r<a.length;r++)for(var s=a[r],d=0,c=s.slot_ids;d<c.length;d++){var l=c[d];o[l]=s.invocation_code}for(var u=function(t){for(var e=void 0,n=0,r=i.placements;n<r.length;n++){var a=r[n];if(a.nativeCallback&&a.impId===t.impid){e=a.nativeCallback;break}}!e&&t.slotid in o&&(e=function(e){executeFunction(o[t.slotid],[e])});var s=GenerateBidResponseSlot(t.slotid,t.impid,t.cpm,t.width,t.height,t.zoneid,e,t.native,t.displayurl,t.creative);void 0!==s&&(window.criteo_pubtag.standaloneBidder.bids[s.id]=s)},p=0,f=e.slots;p<f.length;p++)u(f[p]);e.granularity&&SetLineItemRanges(e.granularity)}if(void 0!==n){for(var h=[],g=0,m=i.placements;g<m.length;g++){var v=m[g];h.push(v.impId)}n(GetBids({impressionIds:h}))}},r,r,o||3e3,i.networkId,i.integrationMode),s=[],d=0,c=i.placements;d<c.length;d++){var l=c[d];s.push(l.impId),metricBuilders[l.slotId]=a.getMetricBuilder(),bidCaches[l.slotId]=a.getBidCache()}window.criteo_pubtag.standaloneBidder.impIds=s,window.criteo_pubtag.push(a)}}function SetLineItemRanges(t){var e=LineItemRange.createLineItemRangesFromString(t);window.criteo_pubtag.standaloneBidder.lineItemRanges=e}function markSetTargetingMetrics(){for(var t=new DirectBiddingMetricsManager,e=t.getMetrics(!1),n={},o=0;o<e.length;++o)for(var i=0,r=e[o].slots;i<r.length;i++)n[r[i].impressionId]=o;for(var a in metricBuilders)if(metricBuilders.hasOwnProperty(a)){var s=metricBuilders[a],d=TimeMeasurer.TimeSincePageLoad()-s.pageLoadElapsed;s.withSetTargetingElapsed(d),a in n&&(e[n[a]]=s.build())}t.setMetrics(e)}function SetDFPKeyValueTargeting(){var t=new DFPKeyValueTargeter;t.resetKeyValuesForSlots(window.criteo_pubtag.standaloneBidder.impIds);var e=window.criteo_pubtag.standaloneBidder.lineItemRanges,n=GetImpressionIdToBestBid();for(var o in n)if(n.hasOwnProperty(o)){var i=ComputeDFPTargeting(n[o],e);void 0!==i&&t.setKeyValuePerSlot(o,i)}markSetTargetingMetrics()}function ComputeStandaloneDFPTargeting(t,e){return ComputeDFPTargeting(t,LineItemRange.createLineItemRangesFromString(e))}function ComputeDFPTargeting(t,e){var n=LineItemRange.computeLineItemPricebandValue(t.cpm,e);return void 0===n?void 0:createDFPTargeting(n,t.id)}function RenderAd(t,e){var n=new RenderAdInputParameters("string"==typeof t?{bidId:t,document:e}:t);if(n.bidId){var o=void 0!==n.containerId?new BidEventContainerTarget(n.document,n.containerId):new BidEventDocumentTarget(n.document);RenderAdOnTarget(n.bidId,o)}else Log.Error("You must provide a bidId to the RenderAd call")}function RenderAdOnTarget(t,e){var n=window.criteo_pubtag.standaloneBidder.bids;if(n.hasOwnProperty(t)){var o=n[t],i=o.GenerateEvent(e);window.criteo_pubtag.push(i),o.slotId in bidCaches&&bidCaches[o.slotId].removeBid(o),delete n[t]}else Log.Error("Could not render bid with id: "+t)}function GetBids(t){var e=window.criteo_pubtag.standaloneBidder.bids;if(null===e)return[];var n=window.criteo_pubtag.standaloneBidder.lineItemRanges,o=[];for(var i in e)if(e.hasOwnProperty(i)){var r=e[i];if(!t||!t.impressionIds||-1!==t.impressionIds.indexOf(r.impressionId)){if(0<n.length){var a=LineItemRange.computeLineItemPricebandValue(r.cpm,n);r.cpm_bucket=a}o.push(r)}}return o}function GetBidsForAdUnit(t,e){void 0===e&&(e=1);var n=GetBids({impressionIds:[t]});return n.sort(function(t,e){return e.cpm-t.cpm}).slice(0,Math.min(Math.max(e,0),n.length))}function checkInputParameters(t){if(void 0===t.placements)return Log.Error("Missing 'placements' parameter"),!1;if(0===t.placements.length)return Log.Error("'placements' parameter is empty"),!1;for(var e=0,n=t.placements;e<n.length;e++){var o=n[e];if(IsEmptyOrUndefined(o.impId))return Log.Error("Missing 'slotId' parameter in placements object"),!1;if(IsEmptyOrUndefined(o.zoneId)&&(IsEmptyOrUndefined(o.sizes)||IsEmptyOrUndefined(t.networkId)))return Log.Error("Missing zone information: specify either a zoneId or a networkId and a zone size"),!1;if(void 0!==o.nativeCallback&&"function"!=typeof o.nativeCallback)return Log.Error("'nativeCallback' parameter is not a function in placements object"),!1}return!0}function GetImpressionIdToBestBid(){var t={},e=window.criteo_pubtag.standaloneBidder.bids;for(var n in e)if(e.hasOwnProperty(n)){var o=e[n];t.hasOwnProperty(o.impressionId)?t[o.impressionId].cpm<o.cpm&&(t[o.impressionId]=o):t[o.impressionId]=o}return t}function GenerateBidResponseSlot(t,e,n,o,i,r,a,s,d,c){return void 0!==a&&void 0!==s?new NativeBidResponseSlot(t,e,n,o,i,r,a,s):void 0===d||void 0!==c&&"<script"!==c.substr(0,7)?void 0!==c?new HtmlCreativeBidResponseSlot(t,e,n,o,i,r,c):void 0:new DisplayUrlBidResponseSlot(t,e,n,o,i,r,d)}function IsEmptyOrUndefined(t){return void 0===t||t+""==""}var AMP=function(){function t(){}return t.Standalone=function(e,n,o){RequestBids({integrationmode:"amp",placements:[{slotid:e.slot,zoneid:e.zone,sizes:[e.width+"x"+e.height]}]},function(i){if("DFP"===e.adserver){t.listenForCreativeRequests(i);for(var r=0,a=i;r<a.length;r++){var s=ComputeStandaloneDFPTargeting(a[r],e.lineItemRanges);void 0!==s&&o(s)}0===i.length&&o({})}n(null)},e.timeout)},t.listenForCreativeRequests=function(t){window.addEventListener("message",function(e){var n=e.data instanceof Object?e.data:tryParseJson(e.data);if(n&&n.bidId&&e.source)for(var o=0,i=t;o<i.length;o++){var r=i[o];if(r.id===n.bidId){var a=e.source,s=r.GenerateMessage();s.message="Criteo creative",a.postMessage(JSON.stringify(s),"*")}}},!1)},t}(),Prebid=function(){function t(t,e,n,o,i){var r,a;this.timer=new DirectBiddingTimer(new DirectBiddingMetricBuilder,o.auctionStart,resolvePrebidTimeout(o.timeout)),this.auctionId=o.auctionId,this.bidRequests=n,this.slots=[];for(var s=0,d=n;s<d.length;s++){var c=d[s];this.slots.push(new DirectBiddingSlot(c.adUnitCode,c.params.zoneId,c.params.nativeCallback,c.transactionId,c.sizes.map(function(t){return new Size(t[0],t[1])}),c.params.publisherSubId)),r=c.params.networkId||r,c.params.integrationMode&&(a=parse(c.params.integrationMode))}var l={};o.gdprConsent&&(void 0!==o.gdprConsent.consentString&&(l.consentData=o.gdprConsent.consentString),void 0!==o.gdprConsent.gdprApplies&&(l.gdprApplies=!!o.gdprConsent.gdprApplies),o.gdprConsent.vendorData&&o.gdprConsent.vendorData.vendorConsents&&void 0!==o.gdprConsent.vendorData.vendorConsents[CRITEO_VENDOR_ID.toString(10)]&&(l.consentGiven=!!o.gdprConsent.vendorData.vendorConsents[CRITEO_VENDOR_ID.toString(10)])),this.metricsManager=new DirectBiddingMetricsManager,this.cache=new DirectBiddingCache(window.criteo_pubtag.context,this.slots,r),this.requestBuilder=new DirectBiddingRequestBuilder(this.cache.filterNoBidSlots(this.slots),window.criteo_pubtag.context,this.metricsManager,new DirectBiddingUrlBuilder(!1),t,a,r,e,l,i),this.url=this.requestBuilder.getUrl(),window.Impressionmedia.prebid_adapters=window.Impressionmedia.prebid_adapters||{},window.Impressionmedia.prebid_adapters[this.auctionId]=this}return t.prototype.buildCdbUrl=function(){return this.url},t.prototype.buildCdbRequest=function(){if(this.cache.silentModeEnabled())Log.Debug("Request ignored because the global silent mode is enabled");else{if(this.requestBuilder.isValid())return this.timer.sendRequest(this.url),this.requestBuilder.getRequest();Log.Debug("Request ignored because it doesnt contain any slot")}},t.GetAllAdapters=function(){return window.Impressionmedia.prebid_adapters},t.GetAdapter=function(e){var n="string"==typeof e?e:e.bidRequests[0].auctionId,o=t.GetAllAdapters();if(o&&n in o)return o[n]},t.prototype.createNativeAd=function(t,e,n){return window.criteo_prebid_native_slots=window.criteo_prebid_native_slots||{},window.criteo_prebid_native_slots[t]={callback:n,payload:e},'<script type="text/javascript">\n            var win = window;\n            for (var i = 0; i < 10; ++i) {\n                win = win.parent;\n                if (win.criteo_prebid_native_slots) {\n                    var responseSlot = win.criteo_prebid_native_slots["'+t+'"];\n                    responseSlot.callback(responseSlot.payload);\n                    break;\n                }\n            }\n        <\/script>'},t.prototype.getBidRequestForSlot=function(t){for(var e=0,n=this.bidRequests;e<n.length;e++){var o=n[e];if(o.adUnitCode===t.impid&&(!o.params.zoneId||parseInt(o.params.zoneId,10)===t.zoneid))return o}},t.prototype.interpretResponse=function(t,e){this.timer.requestReceived();var n=extractExtraData(t),o={};if(void 0!==n.slots)for(var i=0,r=n.slots;i<r.length;i++)o[(c=r[i]).imp_id]=c;var a=[];if(t.slots&&Array.isArray(t.slots))for(var s=0,d=t.slots;s<d.length;s++){var c=d[s],l=this.getBidRequestForSlot(c);if(l){var u=l.bidId,p=c.native?this.createNativeAd(u,c.native,l.params.nativeCallback):c.creative,f=c.ttl||o[c.slotid]&&o[c.slotid].ttl||60;a.push({requestId:u,adId:generateUuid(),cpm:c.cpm,ad:p,currency:c.currency,netRevenue:!0,ttl:f,creativeId:u,width:c.width,height:c.height})}else Log.Error('Could not get bid request for slot "'+c+'"')}return this.cache.handleResponse(this.slots,t,n,!1),this.metricsManager.storeMetric(this.timer.finish(n.slots)),a},t.prototype.handleBidWon=function(t){this.updateMetric(t,function(t){t.adapterBidWon=!0})},t.prototype.handleBidTimeout=function(){this.timer.requestReceived(!0),this.metricsManager.storeMetric(this.timer.finish())},t.prototype.handleSetTargeting=function(t){var e=this;this.timer.setTargeting(),this.updateMetric(t,function(){return e.timer.build()})},t.prototype.updateMetric=function(t,e){for(var n=this.metricsManager.getMetrics(!1),o=0;o<n.length;++o)for(var i=0,r=n[o].slots;i<r.length;i++){var a=r[i];if(a.adUnitId===t.adUnitCode){var s=e(a);s&&(n[o]=s)}}this.metricsManager.setMetrics(n)},t}();function GetIdfs(){return window.criteo_pubtag.context.getIdfs()}function SetIdfs(t){window.criteo_pubtag.context.setIdfs(t)}var AdBlocker=function(){function t(){this.allowedPixelLoaded=!1,this.blockedPixelFailed=!1}return t.prototype.isAdBlocked=function(e,n){var o=this,i="https:"===e?"https:":"http:",r=i+t.allowedPixelUrl,a=i+t.blockedPixelUrl;this.createPixel(r,function(){(o.allowedPixelLoaded=!0)===o.blockedPixelFailed&&n(!0)},function(){}),this.createPixel(a,function(){n(!1)},function(){(o.blockedPixelFailed=!0)===o.allowedPixelLoaded&&n(!0)})},t.prototype.createPixel=function(t,e,n){var o=document.createElement("img");o.src=t,o.height=1,o.width=1,o.style.display="none",o.onload=e,o.onerror=n},t.allowedPixelUrl="//static.criteo.net/images/pixel.gif?ch=1",t.blockedPixelUrl="//static.criteo.net/images/pixel.gif?ch=2",t}(),__extends$13=(eq=function(t,e){return(eq=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}eq(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),eq,ConditionalEvent=function(t){function e(n,o,i,r){var a=t.call(this,e.NAME)||this;return a.condition=n,a.eventIfTrue=o,a.eventIfFalse=i,a.conditionRequirement=r,a}return __extends$13(e,t),e.prototype.canEval=function(){return void 0===this.conditionRequirement||this.conditionRequirement.apply(this)},e.prototype.eval=function(t){this.condition.apply(this)?this.eventIfTrue.eval(t):this.eventIfFalse.eval(t)},e.NAME="conditionalEvent",e}(AbstractEvent),AdFormatType,xq;xq=AdFormatType||(AdFormatType={}),xq[xq.Classic=0]="Classic",xq[xq.StickyFooter=1]="StickyFooter",xq[xq.ScrollingBanner=2]="ScrollingBanner";var CookieHelper=function(){function t(){}return t.SetCookie=function(e,n,o,i,r){void 0===r&&(r=!1);var a=i||document,s=a.location.hostname,d=new Date;d.setTime(d.getTime()+60*o*60*1e3);var c="expires="+d.toUTCString();if(!r)return t.setCookieString(e,n,c,void 0,a),s;for(var l=s.split("."),u=0;u<l.length;++u){var p=l.slice(l.length-u-1,l.length).join(".");t.setCookieString(e,n,c,p,a);var f=t.GetCookie(e,i);if(f&&f===n)return p}return s},t.DeleteCookie=function(e,n,o){void 0===o&&(o=!1),t.SetCookie(e,"",0,n,o)},t.GetCookie=function(t,e){for(var n=0,o=(e||document).cookie.split(";");n<o.length;n++){var i=o[n],r=i.substr(0,i.indexOf("=")).replace(/^\s+|\s+$/g,""),a=i.substr(i.indexOf("=")+1);if(r===t)return decodeURIComponent(a)}},t.setCookieString=function(t,e,n,o,i){var r=t+"="+encodeURIComponent(e)+";"+n+";";o&&""!==o&&(r+="domain=."+o+";"),i.cookie=r+"path=/"},t}(),AdvancedAdFormats=function(){function t(t){this.adFormat=t}return t.prototype.CreateAdvancedAdFormatContainer=function(t){return this.adFormat===AdFormatType.StickyFooter?this.CreateStickyFooterContainer(t):this.adFormat===AdFormatType.ScrollingBanner?this.CreateScrollingBannerContainer(t):void 0},t.prototype.IsUserOptout=function(){return this.adFormat===AdFormatType.StickyFooter&&"true"===CookieHelper.GetCookie("cto_sticky_closed")},t.prototype.CreateStickyFooterContainer=function(t){var e=document.createElement("div");e.style.position="fixed",e.style.zIndex="2147483646",e.style.bottom="0",e.style.left="0",e.style.padding="0",e.style.borderColor="rgb(196, 196, 196)",e.style.width="100%",e.style.backgroundColor="rgba(245, 245, 245, 0.54902)",e.style.borderStyle="solid",e.style.borderWidth="1px";var n=document.createElement("a");e.appendChild(n),n.style.backgroundColor="rgb(221, 221, 221)",n.style.backgroundImage="url('//static.criteo.net/images/criteo/publishertag/close.png')",n.style.backgroundRepeat="no-repeat",n.style.backgroundPosition="center",n.style.display="block",n.style.position="absolute",n.style.left="0",n.style.top="-24px",n.style.width="23px",n.style.height="24px",n.style.borderBottomColor="#6d6c71",n.style.cursor="pointer",n.onclick=function(){e.style.display="none",CookieHelper.SetCookie("cto_sticky_closed","true",24)};var o=document.createElement("div");if(e.appendChild(o),o.id="cto_sticky",o.style.margin="0 auto",o.style.display="table",void 0===t||""===t)document.body.appendChild(e);else{var i=document.getElementById(t);i?i.appendChild(e):Log.Error('Target element "'+t+'" not found in the document')}return o.id},t.prototype.CreateScrollingBannerContainer=function(t){var e,n=this;if(void 0===t||""===t)(e=document.createElement("div")).id="cto_scrolling",document.body.appendChild(e);else{var o=document.getElementById(t);if(!o)return Log.Error('Target element "'+t+'" not found in the document'),t;e=o}var i=e.offsetTop;return window.addEventListener?window.addEventListener("scroll",function(){n.SetScrollingContainerPosition(e,i)},!1):window.attachEvent("onscroll",function(){n.SetScrollingContainerPosition(e,i)}),this.SetScrollingContainerPosition(e,i),e.id},t.prototype.SetScrollingContainerPosition=function(t,e){var n=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;t.style.top=e-10<=n?(t.style.position="fixed","10px"):(t.style.position="static","auto")},t}(),DisplayContext,sr;sr=DisplayContext||(DisplayContext={}),sr[sr.InFriendlyIframe=1]="InFriendlyIframe",sr[sr.InUnfriendlyIframe=2]="InUnfriendlyIframe",sr[sr.DirectIntegration=3]="DirectIntegration";var DomManipulationTools=function(){function t(){}return t.getHighestAccessibleWindow=function(t){var e=t,n=!1;try{for(;e.parent.document!==e.document;){if(!e.parent.document){n=!0;break}e=e.parent}}catch(t){n=!0}return{topFrame:e,err:n}},t.getHighestAccessibleUrl=function(t){var e=t.topFrame;if(!t.err)return e.location.href;try{var n=e.top.location.href;if(n)return n}catch(t){}try{var o=e.location.ancestorOrigins;if(o)return o[o.length-1]}catch(t){}return e.document.referrer},t.inIframe=function(){try{return window.self!==window.top}catch(t){return!0}},t}(),ViewabilityComputer=function(){function t(){}return t.GetAtfRatio=function(e,n){var o=document.getElementById(n);if(e.displayContext===DisplayContext.DirectIntegration){if(null!==o)return t.GetRatioAboveFold(o);document.write("<div id='compute_visibility_helper' width='0px' height='0px'></div>");var i=document.getElementById("compute_visibility_helper"),r=t.GetRatioAboveFold(i);return i.parentElement.removeChild(i),r}if(e.displayContext===DisplayContext.InFriendlyIframe)return t.GetRatioAboveFold(frameElement)},t.GetRatioAboveFold=function(t){var e=DomManipulationTools.getHighestAccessibleWindow(window).topFrame,n=e.document,o=e.innerHeight||n.documentElement.clientHeight||n.body.clientHeight,i=t.getBoundingClientRect(),r=n.documentElement.scrollTop||n.body.scrollTop;return o>=i.bottom+r?1:o<=i.top+r?0:(o-i.top-r)/t.offsetHeight},t}(),__extends$14=(Sr=function(t,e){return(Sr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}Sr(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Sr,DisplayEvent=function(t){function e(e,n,o){var i=t.call(this,e)||this;return i.displayParameters=o,i.urlBuilder=n,i}return __extends$14(e,t),e.prototype.eval=function(t){this.displayParameters.atfRatio=ViewabilityComputer.GetAtfRatio(t.context,this.displayParameters.containerid)},e.prototype.buildCasUrl=function(t,e,n,o,i){var r=this;hasCMP(window)?retrieveGDPRConsent(window,function(a){t(r.urlBuilder.buildUrl(r.displayParameters,e,n,o,i,a))}):t(this.urlBuilder.buildUrl(this.displayParameters,e,n,o,i))},e}(AbstractEvent),HandlerType,ps;ps=HandlerType||(HandlerType={}),ps[ps.AFR=0]="AFR",ps[ps.AJS=1]="AJS";var __extends$15=(qs=function(t,e){return(qs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}qs(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),qs,DisplayEventAFR=function(t){function e(n,o,i){var r=t.call(this,e.NAME,n,o)||this;return r.respectsEyeoDeal=i,r}return __extends$15(e,t),e.prototype.eval=function(e){var n=this;t.prototype.eval.call(this,e);var o=this.displayParameters.containerid,i=this.displayParameters.callbackSuccess,r=this.displayParameters.callbackError;this.buildCasUrl(function(t){if(e.context.isAdBlocked){if(!n.respectsEyeoDeal)return;n.loadIframe(t,o,i,r)}else n.loadIframe(t,o,i,r)},e.context,HandlerType.AFR)},e.prototype.loadIframe=function(t,e,n,o){var i=document.createElement("iframe");i.src=t,i.id=e+"_cto_iframe",i.frameBorder="0",i.setAttribute("hspace","0"),i.setAttribute("vspace","0"),i.marginWidth="0px",i.marginHeight="0px",i.width="100%",i.height="100%",i.scrolling="no",n&&(i.onload=n),o&&(i.onerror=o);var r=document.getElementById(e);r?r.appendChild(i):Log.Error('Target element "'+e+'" not found in the document')},e.NAME="displayAfr",e}(DisplayEvent),__extends$16=(Ts=function(t,e){return(Ts=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}Ts(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Ts,DisplayEventAsync=function(_super){function DisplayEventAsync(t,e){return _super.call(this,DisplayEventAsync.NAME,t,e)||this}return __extends$16(DisplayEventAsync,_super),DisplayEventAsync.prototype.eval=function(t){var e=this;_super.prototype.eval.call(this,t);var n=this.displayParameters.containerid,o=this.displayParameters.width,i=this.displayParameters.height,r=this.displayParameters.layout,a=this.displayParameters.callbackSuccess,s=this.displayParameters.callbackError,d=this.displayParameters.passbackCode;if(""===n||void 0===n)Log.Error("No containerid provided");else if(void 0!==r){var c=DisplayEventAsync.CHAPI_NAME+"="+encodeURIComponent(JSON.stringify(r)),l=function(){var r=e.getContainerSize(n,o,i);e.buildCasUrl(function(t){e.loadScriptAsync(t,c,a,s,d)},t.context,void 0,r.width,r.height)};void 0!==o&&void 0!==i?l():window.addEventListener?window.addEventListener("load",l,!1):window.attachEvent("onload",l)}else this.buildCasUrl(function(t){e.loadScriptAsync(t,void 0,a,s,d)},t.context)},DisplayEventAsync.prototype.loadScriptAsync=function(url,data,callBackSuccess,callbackFail,passbackCode){var request=new AsyncRequest(url,data);request.send(function(responseText){var pb=passbackCode||function(){};eval(responseText),void 0!==callBackSuccess&&callBackSuccess(responseText)},function(t,e){void 0!==passbackCode&&passbackCode(),void 0!==callbackFail&&callbackFail(t,e)},passbackCode)},DisplayEventAsync.prototype.getContainerSize=function(t,e,n){var o=document.getElementById(t),i=DomManipulationTools.inIframe(),r=e||(i?document.body.offsetWidth:o?o.offsetWidth:0),a=n||(i?document.body.offsetHeight:o?o.offsetHeight:0);return(0===r||0===a||r<80||a<40)&&(r=a=void 0),{width:r,height:a}},DisplayEventAsync.NAME="displayEventAsync",DisplayEventAsync.CHAPI_NAME="publisherCreativeConfiguration",DisplayEventAsync}(DisplayEvent),__extends$17=(Bt=function(t,e){return(Bt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}Bt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Bt,DisplayEventSync=function(t){function e(n,o){return t.call(this,e.NAME,n,o)||this}return __extends$17(e,t),e.prototype.eval=function(e){var n=this;t.prototype.eval.call(this,e),this.buildCasUrl(function(t){n.loadScriptSync(t)},e.context)},e.prototype.loadScriptSync=function(t){document.write("<script type='text/javascript' src='"+t+"'><\/script>")},e.NAME="displaySync",e}(DisplayEvent),__extends$18=(Ut=function(t,e){return(Ut=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}Ut(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Ut,DisplayInputParameters=function(t){function e(e){var n=t.call(this)||this;return n.jajaParam=void 0,n.zoneid=void 0,n.async=void 0,n.containerid=void 0,n.width=void 0,n.height=void 0,n.callbackSuccess=void 0,n.callbackError=void 0,n.callIfNotAdblocked=void 0,n.passbackCode=void 0,n.publisherUrl=void 0,n.overridenWpdt0=void 0,n.overridenCt0=void 0,n.layout=void 0,n.atfRatio=void 0,n.adFormat=AdFormatType.Classic,n.overrideZoneFloor=!0,n.collapseContainerIfNotAdblocked=!0,n.extraData={},n.addParameter("jajaparam",function(t){n.jajaparam=t}),n.addParameter("zoneId",function(t){n.zoneid=t}),n.addParameter("async",function(t){n.async=!0===t}),n.addParameter("containerId",function(t){n.containerid=t}),n.addParameter("width",function(t){n.width=t}),n.addParameter("height",function(t){n.height=t}),n.addParameter("callbackSuccess",function(t){n.callbackSuccess=t}),n.addParameter("callbackError",function(t){n.callbackError=t}),n.addParameter("callIfNotAdblocked",function(t){n.callIfNotAdblocked=t}),n.addParameter("passbackCode",function(t){n.passbackCode=t}),n.addParameter("layout",function(t){n.layout=t}),n.addParameter("publisherCreativeConfiguration",function(t){n.layout=t}),n.addParameter("extraData",function(t){n.extraData=t}),n.addParameter("publisherUrl",function(t){n.publisherUrl=t}),n.addParameter("wpdt0",function(t){n.overridenWpdt0=t}),n.addParameter("ct0",function(t){n.overridenCt0=t}),n.addParameter("overrideZoneFloor",function(t){n.overrideZoneFloor=t}),n.addParameter("collapseContainerIfNotAdblocked",function(t){n.collapseContainerIfNotAdblocked=t}),n.addParameter("adFormat",function(t){n.adFormat=n.parseAdFormat(t)}),t.prototype.tryFillParameters.call(n,e),n}return __extends$18(e,t),e.prototype.parseAdFormat=function(t){switch(t.toLowerCase()){case"stickyfooter":return AdFormatType.StickyFooter;case"scrollingbanner":return AdFormatType.ScrollingBanner;default:return AdFormatType.Classic}},e}(InputParameters),DisplayUrlBuilder=function(){function t(){}return t.prototype.buildUrl=function(e,n,o,i,r,a){var s;s=o===HandlerType.AFR?t.CAS_URL_AFR:t.CAS_URL_AJS;var d=("https:"===n.protocol?"https:":"http:")+s+"?ptv="+PublisherTagVersion;if(!0===n.isAdBlocked){var c=this.getAbpParameter(e,n);d+="&abp="+String(c)}for(var l in o!==HandlerType.AFR&&(d+=void 0!==e.containerid&&""!==e.containerid?"&containerid="+encodeURIComponent(e.containerid):""),d+="&zoneid="+String(e.zoneid),d+=i?"&width="+i:"",d+=r?"&height="+r:"",d+=n.ctoIdOnPublisherDomain?"&idcpy="+n.ctoIdOnPublisherDomain:"",d+=n.idfs?"&idfs="+n.idfs:"",d+=n.secureId?"&sid="+n.secureId:"",d+=n.isOptOut?"&optout=1":"",d+="&cb="+String(CacheBusterGenerator.generateCacheBuster()),d+="&nodis="+(n.dising?"0":"1"),d+=n.charset?"&charset="+n.charset:"",d+=e.overridenCt0?"&ct0="+encodeURIComponent(e.overridenCt0):n.ct0?"&ct0="+encodeURIComponent(n.ct0):"",d+=e.overridenWpdt0?"&wpdt0="+encodeURIComponent(e.overridenWpdt0):n.wpdt0?"&wpdt0="+encodeURIComponent(n.wpdt0):"",e.publisherUrl&&(d+="&publisherurl="+encodeURIComponent(e.publisherUrl)),d+=n.getContextFlags(),e.extraData)void 0!==e.extraData[l]&&(d+="&"+l+"="+encodeURIComponent(e.extraData[l]));return d+=e.passbackCode?"&dlp=1":"",e.integrationMode!==IntegrationMode.Unspecified&&(d+="&im="+e.integrationMode),d+="&dc="+n.displayContext,void 0!==e.atfRatio&&(d+="&atfr="+Math.round(100*e.atfRatio)/100),d+=n.highestAccessibleUrl?"&loc="+encodeURIComponent(n.highestAccessibleUrl).substring(0,1600):"",a&&(void 0!==a.consentData&&(d+=a.consentData?"&gdprDta="+a.consentData:""),void 0!==a.consentGiven&&(d+="&gdprGvn="+(a.consentGiven?"1":"0")),void 0!==a.gdprApplies&&(d+="&gdprApp="+(a.gdprApplies?"1":"0"))),d},t.prototype.getAbpParameter=function(t,e){return(e.isAdBlocked?1:0)|(t.overrideZoneFloor?0:2)},t.CAS_URL_AJS="//cas.criteo.com/delivery/ajs.php",t.CAS_URL_AFR="//cas.criteo.com/delivery/afr.php",t}(),EyeoDealValidator=function(){function t(){}return t.prototype.respectsEyeoDeal=function(e){var n=document.getElementById(e);if(!this.respectsSizeConstraints(n))return Log.Debug("The element "+e+"does not respect Eyeo acceptable ads size constraints"),!1;var o=this.getNewRatiosFeatures(n),i=o.respectsAdRatioConstraint;return i?(t.atfRatio=o.newAtfRatio,t.btfRatio=o.newBtfRatio):Log.Debug("The element "+e+"does not respect Eyeo acceptable ads ratio constraints"),i},t.prototype.respectsSizeConstraints=function(t){var e=this.getAdLocationAttribute(t);switch(e){case"above-content":return t.offsetHeight<=200;case"in-content":return!1;case"below-content":return t.offsetHeight<=400;case"side-content":return t.offsetWidth<=350;default:return void 0!==e&&Log.Error("Unknown data-ad-loc attribute : "+e),!0}},t.prototype.getAdLocationAttribute=function(t){return t.getAttribute("data-ad-loc")||void 0},t.prototype.getNewRatiosFeatures=function(e){var n=ViewabilityComputer.GetRatioAboveFold(e),o=e.offsetHeight*e.offsetWidth,i=screen.width*screen.height,r=t.atfRatio+n*o/i,a=t.btfRatio+(1-n)*o/i;return{respectsAdRatioConstraint:r<=.15&&a<=.25,newAtfRatio:r,newBtfRatio:a}},t.atfRatio=0,t.btfRatio=0,t}();function DisplayAd(t){var e=new DisplayInputParameters(t);if(e.async=!1!==e.async,void 0!==e.zoneid)if(void 0===e.layout||!1!==e.async)if(!0!==e.async||void 0!==e.containerid&&""!==e.containerid){if(!1===e.async&&void 0!==e.passbackCode&&(Log.Error("Criteo.DisplayAd does not support synchronous local passback"),e.passbackCode=void 0),e.adFormat!==AdFormatType.Classic){var n=new AdvancedAdFormats(e.adFormat);if(n.IsUserOptout())return void Log.Debug("The user has opted-out for 1 day when closing the sticky footer.");e.containerid=n.CreateAdvancedAdFormatContainer(e.containerid)}var o;o=e.async?new DisplayEventAsync(new DisplayUrlBuilder,e):new DisplayEventSync(new DisplayUrlBuilder,e),window.criteo_pubtag.push(o)}else Log.Error("Missing parameter 'containerid' for an async display");else Log.Error("Criteo hosted ads only work in async mode");else Log.Error("missing parameter 'zoneid'")}function DisplayAcceptableAdIfAdblocked(t){console.log("DisplayAcceptableAdIfAdblocked^^ "),console.log(t);var e=new DisplayInputParameters(t);if(void 0!==e.zoneid)if(void 0!==e.containerid&&""!==e.containerid){var n=document.getElementById(e.containerid);if(isVisible(n)){console.log("window.criteo_pubtag.context^^ "),console.log(window.criteo_pubtag.context),console.log("e.containerid: "+e.containerid);var o=e.containerid.split("-");"staticAds"==o.pop()&&console.log("staticAds: "+o.pop());var i=window.criteo_pubtag.context;(new AdBlocker).isAdBlocked(i.protocol,function(t){i.isAdBlocked=t,window.criteo_pubtag.evalEvents(),console.log("AdBlocker: "+t),console.log(i.isAdBlocked)});var r,a,s;new EyeoDealValidator;r=new DisplayEventAFR(new DisplayUrlBuilder,e,!0),a=new Custom(function(){e.collapseContainerIfNotAdblocked&&(n.style.display="none"),void 0!==e.callIfNotAdblocked&&e.callIfNotAdblocked()}),console.log("r^^"),console.log(a),s=new ConditionalEvent(function(){return!0===window.criteo_pubtag.context.isAdBlocked},r,a,function(){return void 0!==window.criteo_pubtag.context.isAdBlocked}),window.criteo_pubtag.push(s),console.log("s^^"),console.log(s)}else Log.Error("can't display acceptable ad : the container \""+e.containerid+'" is not visible')}else Log.Error("missing parameter 'containerid' to display acceptable ads");else Log.Error("missing parameter 'zoneid'")}function isVisible(t){if(t===document)return!0;if(!t)return!1;if(!t.parentNode)return!1;if(t.style){if("none"===t.style.display)return!1;if("hidden"===t.style.visibility)return!1}if(window.getComputedStyle){var e=window.getComputedStyle(t,"");if("none"===e.display)return!1;if("hidden"===e.visibility)return!1}var n=t.currentStyle;if(n){if("none"===n.display)return!1;if("hidden"===n.visibility)return!1}return isVisible(t.parentNode)}var Polyfills=function(){function t(){}return t.LoadPolyfills=function(){t.DefineIsArray(),t.DefineIndexOf(),t.DefineFilter()},t.DefineIsArray=function(){Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)})},t.DefineIndexOf=function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){if(void 0===e&&(e=0),void 0===this)throw new TypeError("'this' is null or not defined");var n=this.length;if(0===n)return-1;if(n<=e)return-1;for(var o=Math.max(0<=e?e:n-Math.abs(e),0);o<n;){if(o in this&&this[o]===t)return o;o++}return-1})},t.DefineFilter=function(){Array.prototype.filter||(Array.prototype.filter=function(t){if(void 0===this||void 0===this)throw new TypeError;var e=this.length;if("function"!=typeof t)throw new TypeError;for(var n=[],o=2<=arguments.length?arguments[1]:void 0,i=0;i<e;i++)if(i in this){var r=this[i];t.call(o,r,i,this)&&n.push(r)}return n})},t}(),StorageOrigin,Pv;function tryDecodeURIComponent(t,e){try{return decodeURIComponent(t)}catch(n){return void 0!==e?e:t}}function parseUri(t){var e=document.createElement("a");return e.href=t,{protocol:e.protocol,host:e.host,hostname:e.hostname,pathname:"/"===e.pathname[0]?e.pathname.slice(1):e.pathname,search:e.search,href:e.href}}Pv=StorageOrigin||(StorageOrigin={}),Pv[Pv.None=0]="None",Pv[Pv.Cookie=1]="Cookie",Pv[Pv.LocalStorage=2]="LocalStorage";var CookieSynchronizer=function(){function t(t,e,n){this.isDebug=e,this.topWin=t,this.topDoc=t.document,this.localStorageHelper=new LocalStorageHelper(this.topWin),this.localStorageEnabled=this.localStorageHelper.checkLocalStorage(),this.canWriteCookies=this.checkCookiesAreWriteable(),this.topUrl=n}return t.isSafariBrowser=function(){return null!==navigator.userAgent.match(t.SAFARI_CHECK_REGEX)},t.isAndroidBrowser=function(){return-1<navigator.userAgent.toLowerCase().indexOf("android")},t.isFirefoxBrowser=function(){return-1<navigator.userAgent.toLowerCase().indexOf("firefox")},t.prototype.synchronizeCriteoUid=function(e){var n=this;if((e||t.isSafariBrowser()||t.isAndroidBrowser()||t.isFirefoxBrowser())&&this.topWin.addEventListener)if("complete"===this.topDoc.readyState)this.appendGumIframeIfDoesNotExist();else{var o=function(){n.topDoc.removeEventListener("DOMContentLoaded",o),n.topWin.removeEventListener("load",o),n.appendGumIframeIfDoesNotExist()};this.topWin.addEventListener("load",o,!1),this.topDoc.addEventListener("DOMContentLoaded",o,!1)}},t.prototype.appendGumIframeIfDoesNotExist=function(){var e=this,n=this.createGumIframe();this.topDoc.getElementById(t.SYNCFRAME_ID)||(this.topWin.addEventListener("message",function(t){var n=t.data;n&&n.isCriteoMessage&&(t.stopImmediatePropagation(),n.optout?(e.setClientSideOptOut(),e.deleteClientSideUid(),e.deleteClientSideIdfs(),e.deleteClientSideSecureId()):(n.uid&&e.setClientSideUid(n.uid),n.idfs&&e.setClientSideIdfs(n.idfs),n.removeSid?e.deleteClientSideSecureId():n.sid&&e.setClientSideSecureId(n.sid)))},!0),this.topDoc.body.appendChild(n))},t.prototype.getClientSideUid=function(){return this.getFromAllStorages(t.GUID_COOKIE_NAME)},t.prototype.setClientSideUid=function(e){this.writeOnAllStorages(t.GUID_COOKIE_NAME,e,t.GUID_RETENTION_TIME_HOUR)},t.prototype.deleteClientSideUid=function(){this.deleteFromAllStorage(t.GUID_COOKIE_NAME)},t.prototype.getClientSideOptOut=function(){var e=this.getFromAllStorages(t.OPTOUT_COOKIE_NAME);return{value:"1"===e.value,origin:e.origin}},t.prototype.setClientSideOptOut=function(){this.writeOnAllStorages(t.OPTOUT_COOKIE_NAME,"1",t.OPTOUT_RETENTION_TIME_HOUR)},t.prototype.deleteClientSideIdfs=function(){this.deleteFromAllStorage(t.IDFS_COOKIE_NAME)},t.prototype.getClientSideIdfs=function(){return this.getFromAllStorages(t.IDFS_COOKIE_NAME)},t.prototype.setClientSideIdfs=function(e){this.writeOnAllStorages(t.IDFS_COOKIE_NAME,e,t.GUID_RETENTION_TIME_HOUR)},t.prototype.getClientSideSecureId=function(){return this.getFromAllStorages(t.SECURE_ID_COOKIE_NAME)},t.prototype.setClientSideSecureId=function(e){this.writeOnAllStorages(t.SECURE_ID_COOKIE_NAME,e,t.GUID_RETENTION_TIME_HOUR)},t.prototype.deleteClientSideSecureId=function(){this.deleteFromAllStorage(t.SECURE_ID_COOKIE_NAME)},t.prototype.getLocalWebId=function(){var e=this.getFromAllStorages(t.LOCAL_WEB_ID_COOKIE_NAME);if(this.canWriteCookies){var n=e.value;n||(n=generateUuid()),this.writeOnAllStorages(t.LOCAL_WEB_ID_COOKIE_NAME,String(n),t.GUID_RETENTION_TIME_HOUR),e=this.getFromAllStorages(t.LOCAL_WEB_ID_COOKIE_NAME)}return e.value&&e||{value:"NA",origin:StorageOrigin.None}},t.prototype.checkCookiesAreWriteable=function(){var t="cto_writeable";CookieHelper.SetCookie(t,"1",1,this.topDoc,!0);var e="1"===CookieHelper.GetCookie(t,this.topDoc);return CookieHelper.DeleteCookie(t,this.topDoc,!0),e},t.prototype.createGumIframe=function(){var e=this.topDoc.createElement("iframe"),n=this.buildSyncframeSrc();return e.src=n,e.id=t.SYNCFRAME_ID,e.style.display="none",e},t.prototype.writeOnAllStorages=function(t,e,n){this.localStorageEnabled&&this.localStorageHelper.setItem(t,e),CookieHelper.SetCookie(t,e,n,this.topDoc,!0)},t.prototype.getFromAllStorages=function(t){var e,n=CookieHelper.GetCookie(t,this.topDoc);return this.localStorageEnabled&&(e=this.localStorageHelper.getItem(t)||void 0),{value:n||e,origin:(n&&StorageOrigin.Cookie)|(e&&StorageOrigin.LocalStorage)}},t.prototype.deleteFromAllStorage=function(t){CookieHelper.DeleteCookie(t,this.topDoc,!0),this.localStorageEnabled&&this.localStorageHelper.removeItem(t)},t.prototype.getTld=function(){var e=CookieHelper.SetCookie(t.TLD_TEST_COOKIE_NAME,"test",1,this.topDoc,!0);return CookieHelper.DeleteCookie(t.TLD_TEST_COOKIE_NAME,this.topDoc,!0),e},t.prototype.buildSyncframeSrc=function(){var t=this.getClientSideUid(),e=this.getClientSideIdfs(),n=this.getClientSideOptOut(),o=this.getClientSideSecureId(),i=this.getLocalWebId(),r=this.getTld(),a=encodeURIComponent(parseUri(this.topUrl).hostname),s=PublisherTagVersion;return"https://gum.criteo.com/syncframe?topUrl="+a+(this.isDebug?"&debug=1":"")+"#"+JSON.stringify({optout:n,uid:t,idfs:e,sid:o,origin:"publishertag",version:s,lwid:i,tld:r,topUrl:a})},t.GUID_COOKIE_NAME="cto_idcpy",t.GUID_RETENTION_TIME_HOUR=9360,t.IDFS_COOKIE_NAME="cto_idfs",t.SECURE_ID_COOKIE_NAME="cto_sid",t.LOCAL_WEB_ID_COOKIE_NAME="cto_lwid",t.OPTOUT_COOKIE_NAME="cto_optout",t.OPTOUT_RETENTION_TIME_HOUR=43200,t.TLD_TEST_COOKIE_NAME="cto_pub_test_tld",t.SYNCFRAME_ID="criteo-syncframe",t.SAFARI_CHECK_REGEX=/^Mozilla\/5\.0 \([^)]+\) AppleWebKit\/[^ ]+ \(KHTML, like Gecko\) Version\/([^ ]+)( Mobile\/[^ ]+)? Safari\/[^ ]+$/i,t}(),Context=function(){function t(t,e){this.charset=t.charset||t.characterSet||"";var n=DomManipulationTools.getHighestAccessibleWindow(e);this.displayContext=this.getDisplayContext(n),this.highestAccessibleUrl=DomManipulationTools.getHighestAccessibleUrl(n),this.synchronizeCriteoUid(n,this.highestAccessibleUrl);var o=this.getQueryStringParams(this.highestAccessibleUrl);this.debugMode="1"===o.pbt_debug||!1,this.noLog="1"===o.pbt_nolog||!1,this.shouldIgnoreSilentMode=this.computeShouldIgnoreSilentMode(),this.silentModeIgnored=!1,this.debugMode&&SetLogLevel(LogLevel.Debug),this.location=e.location,this.protocol=e.location.protocol,this.dising=!1,this.ct0=void 0,this.wpdt0=void 0,this.isAdBlocked=void 0,this.rtaVarNames=[]}return t.prototype.getContextFlags=function(){var t="";return(t+=this.debugMode?"&debug=1":"")+(this.noLog?"&nolog=1":"")},t.prototype.getDisplayContext=function(t){return DomManipulationTools.inIframe()?t.err?DisplayContext.InUnfriendlyIframe:DisplayContext.InFriendlyIframe:DisplayContext.DirectIntegration},t.prototype.getQueryStringParams=function(t){var e={},n=t.split("?");if(1<n.length)for(var o=0,i=n[1].split("&");o<i.length;o++){var r=i[o].split("=");e[tryDecodeURIComponent(r[0])]=tryDecodeURIComponent(r[1])}return e},t.prototype.synchronizeCriteoUid=function(t,e){var n=t.topFrame,o=new CookieSynchronizer(n,this.debugMode,e);this.ctoIdOnPublisherDomain=o.getClientSideUid().value,this.isOptOut=o.getClientSideOptOut().value,this.idfs=o.getClientSideIdfs().value,this.secureId=o.getClientSideSecureId().value,o.synchronizeCriteoUid()},t.prototype.getIdfs=function(){return[this.idfs,this.secureId].join(":")},t.prototype.setIdfs=function(t){var e=t.split(":");e[0]&&(this.idfs=e[0]),e[1]&&(this.secureId=e[1])},t.prototype.computeShouldIgnoreSilentMode=function(){return Math.floor(100*Math.random())<5},t.prototype.setSilentModeIgnored=function(){this.silentModeIgnored=!0},t}(),StandaloneDirectBidder=function(){this.bids={},this.lineItemRanges=[],this.impIds=[]};function isConditionalEvent(t){return"conditionalEvent"===t.name}var PublisherTag=function(){function t(){this.standaloneBidder=new StandaloneDirectBidder,this.events=[],this.context=new Context(document,window),Log.Debug("Publisher Tag loaded")}return t.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0,o=t;n<o.length;n++){var i=o[n];this.events.push(i)}this.evalEvents()},t.prototype.evalEvents=function(){for(var t=0;t<this.events.length;){var e=this.events[t];if(isConditionalEvent(e)&&!e.canEval())t++;else{var n=this.events.splice(t,1);try{n[0].eval(this)}catch(t){Log.Error("An exception occurred processing an event: "+t.toString())}}}},t.VERSION=PublisherTagVersion,t}();function safeFunction(t){var e=t,n=function(){try{return e.apply(this,arguments)}catch(t){Log.Error("Exception caught: "+t.toString())}};for(var o in n.prototype=e.prototype,e)e.hasOwnProperty(o)&&(n[o]=e[o]);return n}function safeObject(t){for(var e in t)if(t.hasOwnProperty(e)){var n=t[e];"function"==typeof n?t[e]=safeFunction(n):"object"==typeof n&&(t[e]=safeObject(n))}return t}function createEventProcessor(t){var e={push:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(void 0!==t)for(var n=0,o=t;n<o.length;n++){var i=o[n];"function"==typeof i&&safeFunction(i)()}}};return t&&Array.isArray(t)&&e.push.apply(e,t),e}var __extends$19=(zx=function(t,e){return(zx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}zx(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),zx,DefaultCrtgContentName="crtg_content",DefaultCrtgRtaCookieName="crtg_rta",RtaInputParameters=function(t){function e(e){var n=t.call(this)||this;return n.networkId=void 0,n.crtgContentName=void 0,n.crtgRtaCookieName=void 0,n.adserver=void 0,n.addParameter("networkId",function(t){n.networkId=t}),n.addParameter("varName",function(t){n.crtgContentName=t}),n.addParameter("cookieName",function(t){n.crtgRtaCookieName=t}),n.addParameter("adserver",function(t){n.adserver=t}),t.prototype.tryFillParameters.call(n,e),n}return __extends$19(e,t),e}(InputParameters),__extends$20=(Sx=function(t,e){return(Sx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}Sx(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Sx,RtaEvent=function(_super){function RtaEvent(t,e){var n=_super.call(this,RtaEvent.NAME)||this;return n.urlBuilder=t,n.parameters=e,n}return __extends$20(RtaEvent,_super),RtaEvent.prototype.eval=function(t){_super.prototype.eval.call(this,t);var e=this.urlBuilder.buildUrl(this.parameters,t.context),n=new AsyncRequest(e),o=this.parameters.crtgContentName||DefaultCrtgContentName;-1===t.context.rtaVarNames.indexOf(o,0)&&t.context.rtaVarNames.push(o),n.send(this.executeScript,function(){return Log.Error("An error occured while calling "+e)})},RtaEvent.prototype.executeScript=function(responseText){eval(responseText)},RtaEvent.NAME="rtaEvent",RtaEvent}(AbstractEvent);function ExtractKeyValuesFromRtaResponse(t){if(void 0===t||""===t)return{};for(var e={},n=0,o=t.split(";");n<o.length;n++){var i=o[n];if(""!==i){var r=i.split("=");if(2===r.length){var a=r[0],s=r[1];e[a]=e[a]||[],e[a].push(""+s)}}}return e}var __extends$21=(ty=function(t,e){return(ty=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}ty(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),ty,RtaTargetingEvent=function(t){function e(n,o){var i=t.call(this,e.NAME)||this;return i.adserver=n,i.targetingValues=o,i}return __extends$21(e,t),e.prototype.eval=function(t){if(void 0!==this.adserver)switch(this.adserver.toLowerCase()){case"dfp":this.setTargetingDFP(this.targetingValues);break;default:Log.Error("unknown adserver '"+this.adserver+"'")}else Log.Error("undefined adserver")},e.prototype.setTargetingDFP=function(t){(new DFPKeyValueTargeter).setKeyValuesForAllSlots(t)},e.NAME="rtaTargetingEvent",e}(AbstractEvent),RtaUrlBuilder=function(){function t(){}return t.prototype.buildUrl=function(e,n){var o=("https:"===n.protocol?"https:":"http:")+t.RTA_URL+"?ptv="+PublisherTagVersion;return!0===n.isAdBlocked&&(o+="&abp=1"),o+="&netid="+String(e.networkId),o+=n.ctoIdOnPublisherDomain?"&idcpy="+n.ctoIdOnPublisherDomain:"",o+=n.idfs?"&idfs="+n.idfs:"",o+=n.secureId?"&sid="+n.secureId:"",o+=n.isOptOut?"&optout=1":"",e.crtgRtaCookieName&&(o+="&cookieName="+encodeURIComponent(e.crtgRtaCookieName)),e.crtgContentName&&(o+="&varName="+encodeURIComponent(e.crtgContentName)),o+="&rnd="+String(CacheBusterGenerator.generateCacheBuster()),o+=n.getContextFlags(),e.integrationMode!==IntegrationMode.Unspecified&&(o+="&im="+e.integrationMode),o},t.RTA_URL="//rtax.criteo.com/delivery/rta/rta.js",t}();function CallRTA(t){var e=new RtaInputParameters(t);if(void 0!==e.networkId){var n=e.crtgContentName?e.crtgContentName:DefaultCrtgContentName,o=e.crtgRtaCookieName?e.crtgRtaCookieName:DefaultCrtgRtaCookieName;window[n]=CookieHelper.GetCookie(o)||"";var i=new RtaEvent(new RtaUrlBuilder,e);console.log("IM CallRTA >> new RtaEvent << new RtaUrlBuilder :: stringify^^"),console.log(JSON.stringify(i)),window.criteo_pubtag.push(i)}else Log.Error("missing parameter 'networkid'")}function SetTargeting(t){var e=new RtaInputParameters(t);if(void 0!==e.adserver){var n=[];if(void 0!==e.crtgContentName)n.push(e.crtgContentName);else if(0<window.criteo_pubtag.context.rtaVarNames.length)for(var o=0,i=window.criteo_pubtag.context.rtaVarNames;o<i.length;o++){var r=i[o];n.push(r)}else n.push(DefaultCrtgContentName);for(var a=0,s=n;a<s.length;a++){var d=s[a],c=ExtractKeyValuesFromRtaResponse(window[d]),l=new RtaTargetingEvent(e.adserver,c);window.criteo_pubtag.push(l),RemoveCrtgContentNameFromPublisherTagContext(d)}}else Log.Error("missing parameter 'adserver'")}function ComputeDFPTargetingForAMP(t,e){var n=ExtractKeyValuesFromRtaResponse(CookieHelper.GetCookie(t));return RemoveCrtgContentNameFromPublisherTagContext(e),n}function RemoveCrtgContentNameFromPublisherTagContext(t){var e=window.criteo_pubtag.context.rtaVarNames.indexOf(t,0);-1<e&&window.criteo_pubtag.context.rtaVarNames.splice(e,1)}var passbackProfileId=206;function SetupPassbackEventQueue(){window.Impressionmedia.passbackEvents=createEventProcessor(window.Impressionmedia.passbackEvents)}function RequestBidsPassback(t,e){RequestBidsWithProfileId(t,passbackProfileId,SetupPassbackEventQueue,e)}function RenderAdPassback(t,e,n,o){var i;"string"==typeof t?i=t:(i=getParam(t,"adUnit","string"),e=getParam(t,"passback","function"),n=getParam(t,"customRenderFunction","function"),o=getParam(t,"minimumBidPrice","number")),void 0!==i?void 0!==e?("function"!=typeof n&&(n=function(t){RenderAd({bidId:t.id,containerId:i})}),window.Impressionmedia.passbackEvents=window.Impressionmedia.passbackEvents||[],window.Impressionmedia.passbackEvents.push(function(){var t=GetBidsForAdUnit(i)[0];t&&(void 0===o||t.cpm>o)?n(t):e(i)})):Log.Error("A passback callback should be provided"):Log.Error("An adUnit string parameter should be provided")}window.criteo_pubtag||(Polyfills.LoadPolyfills(),window.criteo_pubtag=new PublisherTag),window.Impressionmedia=safeObject({CallRTA:CallRTA,ComputeDFPTargetingForAMP:ComputeDFPTargetingForAMP,SetTargeting:SetTargeting,DisplayAd:DisplayAd,DisplayAcceptableAdIfAdblocked:DisplayAcceptableAdIfAdblocked,ComputeStandaloneDFPTargeting:ComputeStandaloneDFPTargeting,GetBids:GetBids,GetBidsForAdUnit:GetBidsForAdUnit,RenderAd:RenderAd,RequestBids:RequestBids,RequestBidsOnGoogleTagSlots:RequestBidsOnGoogleTagSlots,SetDFPKeyValueTargeting:SetDFPKeyValueTargeting,SetLineItemRanges:SetLineItemRanges,Passback:{RequestBids:RequestBidsPassback,RenderAd:RenderAdPassback},PubTag:{Adapters:{AMP:AMP,Prebid:Prebid},Context:{SetIdfs:SetIdfs,GetIdfs:GetIdfs},DirectBidding:{DirectBiddingEvent:DirectBiddingEventWithCaching,DirectBiddingSlot:DirectBiddingSlot,DirectBiddingUrlBuilder:DirectBiddingUrlBuilder,Size:Size},RTA:{DefaultCrtgContentName:DefaultCrtgContentName,DefaultCrtgRtaCookieName:DefaultCrtgRtaCookieName}},events:window.Impressionmedia?window.Impressionmedia.events:[],passbackEvents:window.Impressionmedia?window.Impressionmedia.passbackEvents:[],usePrebidEvents:!window.Impressionmedia||window.Impressionmedia.usePrebidEvents}),window.Impressionmedia.events=createEventProcessor(window.Impressionmedia.events)}();